<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <title>Scheme+.html</title>
  </head>
  <body>
    <div align="center"><br>
    </div>
    <div align="center"><br>
    </div>
    <div align="center"><img moz-do-not-send="true"
        src="Scheme+io_fichiers/Scheme+.png" title="by Damien MATTEI"
        alt="Scheme+" width="290" height="65"></div>
    <h2 style="text-align: center;"><span style="color: #00cccc;"><i>Enhancing







          Scheme (and Lisp-like) language. </i></span></h2>
    <h2 style=" text-align: center;">Damien Mattei<br>
    </h2>
    <p style="text-align: center;"><i><br>
      </i></p>
    <p style="text-align: center;"><i>"Doubts are such tiny things. A
        mind with no room for doubts must have no room for thoughts
        either."</i> -<a href="https://www.ics.uci.edu/%7Epattis/"
        target="_blank">R. Patti</a></p>
    <p style="text-align: center;"><br>
    </p>
    <h1 style="text-align: center;"><b><span style="color: #000099;">Scheme+</span></b><b><span
          style="color: #999999;"> <font size="+2">version 7.1 for
            Racket Scheme<br>
          </font></span></b></h1>
    <p style="text-align: center;"> </p>
    <p style="text-align: center;"><br>
    </p>
    <p><br>
    </p>
    <h2><u>1. Scheme+ at a glance:&nbsp;</u></h2>
    <p><b>Scheme+ is an extension of the syntax of the <a
          href="https://en.wikipedia.org/wiki/Scheme_%28programming_language%29"
          target="_blank">Scheme</a> language.</b></p>
    <p><b>Scheme+ makes it easy the assignment of Scheme objects </b><b>in







        infix </b><b>(works also in prefix) </b><b>notation </b><b>with






        a few new operators&nbsp;</b><b> </b><b><b><b>← (or&nbsp;</b></b>
        &lt;-), [ ],</b><b><font size="+2">⥆ </font>(or &lt;+) . </b><br>
    </p>
    <p><b>The idea of Scheme+ first come to my mind when comparing the
        assignation syntax used in Clojure with Scheme and Lisp, and
        later the easyness of creating and assigning variables in Python
        completely convince me that the Scheme system have to be
        enhanced.</b><br>
    </p>
    <p>The <b>idea</b> of <b>Scheme+</b> is came from this : <b><i>"Why






          is it so boring to define variables in Scheme with the
          traditionnal set of LET,LET*,LETREC,LET-VALUES special forms?"</i></b>
      and <b><i>"Is it possible to use a single mechanism for
          assignment in Scheme?"</i></b></p>
    <p>It comes also from the ascertainment that <i><b>"A computer
          language is created by ONE man, later, a community only bring
          a library to the language without self-questioning any more on
          the fundations of language itself."</b></i></p>
    <p><i><b><br>
        </b></i></p>
    <p><i>Scheme+</i> brings syntax to classic <i>Scheme</i> language
      like those:</p>
    <p><br>
    </p>
    <p style="margin-left: 40px;"><b>{x &lt;- y} </b>infix assignment
      of the value of y to the variable x.</p>
    <p style="margin-left: 40px;">The same thing with a new symbol
      ←&nbsp; :&nbsp; (unicode 2190 in hexadecimal that can be enter
      under Linux with Ctrl-Shift u 2190 Enter or Space bar)</p>
<p style="margin-left: 40px;"><b>{x ← y}</b></p>
<p style="margin-left: 40px;"><b>With operator precedence: {xp <- {x - v * t} / (sqrt {1 - v ** 2 / c ** 2})}</b></p>
<div style="margin-left: 40px;"> </div>
<p style="margin-left: 40px;"><b> {M_i_o[j {i + 1}]  <-  M_i_o[j {i + 1}] - {(- η) * z_input[i] * მzⳆმz̃(z_output[j] z̃_output[j]) * ᐁ_i_o[j]}}</b></p>
    <p style="margin-left: 40px;">Assignment from right to left : <b>{y
        ← 7}</b></p>
    <p style="margin-left: 40px;">Assignment from left to right : <b>{7
        → y}<br>
      </b><br>
      <b> </b></p>
    <blockquote>
      <p><font size="+3">⥆</font>&nbsp; or &lt;+ : Define and assign a
        new variable in the current environment ,example : <font
          size="+2">{v ⥆ 7}</font></p>
    </blockquote>
    <p style="margin-left: 40px;"> </p>
    <p style="margin-left: 40px;">(unicode 2946 , on <a
href="https://apple.stackexchange.com/questions/183045/how-can-i-type-unicode-characters-without-using-the-mouse"
        moz-do-not-send="true">Mac OS use </a> <a
href="https://apple.stackexchange.com/questions/183045/how-can-i-type-unicode-characters-without-using-the-mouse"
        moz-do-not-send="true">CTRL+CMD+space to bring up the characters
        popover, </a> <a
href="https://apple.stackexchange.com/questions/183045/how-can-i-type-unicode-characters-without-using-the-mouse"
        moz-do-not-send="true">then type in u+unicode (ex: u+2946) and
        hit Enter to get it</a><br>
      , and in Emacs you can insert an unicode char with the sequence: <code>‘C-x









        8 RET’</code> followed with unicode of the character you want)</p>
    <p style="margin-left: 40px;"><b>{T[k]} </b>return value of vector
      or array T indexed by k.</p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;"><b>{T</b><b>[k] &lt;- x} </b>infix
      assignment of <b>T</b><b>[k] </b>with x.</p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;"><b>{T</b><b>[k] &lt;-
    </b><b><b>T</b><b>[k + 1]</b>} </b>in infix or the same with a little part of
      classic prefix Scheme:&nbsp; <b>{T</b><b>[k] &lt;-
    </b><b><b>T</b><b>[(+ k 1)]</b>} <br>
      </b></p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;">the same with multi dimensional arrays
      or matrix: <br>
      <b><b>{</b>T</b><b>[m n]} </b>return the value of the multi
      dimension array T indexed by m and n</p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;"><b><b>{</b>T</b><b>[m n] &lt;- </b><b><b>T</b><b>[m {n + 1}]</b>}</b></p>
    <p style="margin-left: 40px;"><br>
      <b><b>{</b>T</b><b>[m n] ← </b><b><b>T</b><b>[m {n + 1}]</b>}<br>
        <br>
      </b></p>
    <p style="margin-left: 40px;"><b>compatible with strings:</b></p>
    <p style="margin-left: 40px;"><b>{str &lt;+ (string-copy "hello")}<br>
      </b></p>
    <p style="margin-left: 40px;"><b>"hello"<br>
      </b></p>
    <p style="margin-left: 40px;"><b>{str[4]}<br>
      </b></p>
    <p style="margin-left: 40px;"><b>#\o<br>
      </b></p>
    <p style="margin-left: 40px;"><b>{str[4] &lt;- #\a}<br>
      </b></p>
    <p style="margin-left: 40px;"><b>#\a<br>
      </b></p>
    <p style="margin-left: 40px;"><b>str<br>
      </b></p>
    <p style="margin-left: 40px;"><b>"hella"</b></p>
    <br>
    <p style="margin-left: 40px;"><b>with function definition:<br>
      </b></p>
    <p style="margin-left: 40px;"><b>(declare fact)<br>
        {fact &lt;- (λ (n) (if {n &lt;&gt; 0} {n * (fact {n - 1})} 1))}<br>
      </b></p>
    <p style="margin-left: 40px;"><b>or just:<br>
      </b></p>
    <p style="margin-left: 40px;"><font size="+1"><b>{fact ⥆ (λ (n) (if
          {n &lt;&gt; 0} {n * (fact {n - 1})} 1))}</b></font></p>
    <p style="margin-left: 40px;"><b>{fact(8)}<br>
        40320<br>
      </b></p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;"> no more need of <strike>LET,LET*,LETREC,LET-VALUES</strike>,...






















    </p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;"><b>←</b><b> is an n-arity operator,
        example :</b></p>
    <p style="margin-left: 40px;">(declare x y z t)<br>
      {x ← y ← z ← t ← 7}<br>
      &nbsp;7<br>
      &nbsp;(list x y z t)<br>
      &nbsp;(7 7 7 7)</p>
    <p style="margin-left: 40px;">Another example which build an
      identity matrix:<br>
    </p>
    <p style="margin-left: 40px;">(require srfi/25)<br>
    </p>
    <p style="margin-left: 40px;">&nbsp;(declare I)<br>
      &nbsp;{I ← (make-array (shape 0 4 0 4))}<br>
      &nbsp; <br>
      &nbsp;&nbsp;&nbsp; <br>
      &nbsp;{I[0 0] ← I[1 1] ← I[2 2] ← I[3 3] ← 1}<br>
      &nbsp;1<br>
      &nbsp;&nbsp;&nbsp; <br>
      &nbsp;&nbsp;I<br>
      &nbsp; #&lt;array:srfi-9-record-type-descriptor&gt;</p>
    <p style="margin-left: 40px;">&gt; {I[0 0]}<br>
      1<br>
      &gt; {I[0 1]}<br>
      0<br>
      <br>
      defining new functions with <b>def </b>instead of the classic
      define we can now use <b>return</b> to escape immediately from the current level of recursive call and <b>return-rec</b> to escape from the full stack of recursive calls:<br>
    </p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;"><b>(return)</b><br>
    </p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;">or returning the value v: </p>
    <div style="margin-left: 40px;"> <b>(return </b>v<b>)</b></div>
    <p style="text-align: left;"><b> &nbsp;&nbsp;&nbsp;
        &nbsp;&nbsp;&nbsp; </b><br>
    </p>
    <p style="margin-left: 40px;">The &lt;+ operator works also for
      defining multiple values :<br>
    </p>
    <p style="margin-left: 40px;">{(a b c) &lt;+ (values 7 8 9)}<br>
      7<br>
      8<br>
      9<br>
      (list a b c)<br>
      '(7 8 9)<br>
    </p>
    <p style="margin-left: 40px;">{(x y z) &lt;+ (u v w) &lt;+ (a b
      c)&nbsp; &lt;+ (values 2 4 5)}<br>
      2<br>
      4<br>
      5<br>
      (list x y z u v w a b c)<br>
      '(2 4 5 2 4 5 2 4 5)<br>
    </p>
    <p style="margin-left: 40px;">We can also assign multiple values on
      the fly:<br>
    </p>
    <p style="margin-left: 40px;">(declare x y z)<br>
      {(x y z) &lt;v (values 2 4 5)}<br>
      2<br>
      4<br>
      5<br>
      (list x y z)<br>
      '(2 4 5)<br>
      (declare u v w)<br>
      {(x y z) &lt;v (u v w) &lt;v (values 2 4 5)}<br>
      2<br>
      4<br>
      5<br>
      (list x y z u v w)<br>
      '(2 4 5 2 4 5)<br>
    </p>
    <p style="margin-left: 40px;"><br>
    </p>
    <p style="text-align: left;"><b> </b></p>
    <p>Here is an example of the previous features about a <a
href="https://en.wikipedia.org/wiki/Subset_sum_problem#Pseudo-polynomial_time_dynamic_programming_solutions"
        target="_blank">dynamic solution of the subset sum problem</a>:</p>
    <p>
      <!-- HTML generated using hilite.me --></p>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">#lang reader "SRFI-105.rkt"<br><br></span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">require</span> <span style="color: #ffffff">Scheme-PLUS-for-Racket/</span><span style="color: #ff0086; font-weight: bold"></span><span style="color: #ffffff">Scheme+)</span>
</pre>
      <br>
      <br>
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">L-init</span> <span style="color: #fb660a">t-init</span> <span style="color: #fb660a">ls</span> <span style="color: #fb660a">dyna</span> <span style="color: #fb660a">cpt</span><span style="color: #ffffff">)</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">L-init</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">'(</span><span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086f7; font-weight: bold">3</span> <span style="color: #0086f7; font-weight: bold">4</span> <span style="color: #0086f7; font-weight: bold">16</span> <span style="color: #0086f7; font-weight: bold">17</span> <span style="color: #0086f7; font-weight: bold">24</span> <span style="color: #0086f7; font-weight: bold">45</span> <span style="color: #0086f7; font-weight: bold">64</span> <span style="color: #0086f7; font-weight: bold">197</span> <span style="color: #0086f7; font-weight: bold">256</span> <span style="color: #0086f7; font-weight: bold">275</span> <span style="color: #0086f7; font-weight: bold">323</span> <span style="color: #0086f7; font-weight: bold">540</span> <span style="color: #0086f7; font-weight: bold">723</span> <span style="color: #0086f7; font-weight: bold">889</span> <span style="color: #0086f7; font-weight: bold">915</span> <span style="color: #0086f7; font-weight: bold">1040</span> <span style="color: #0086f7; font-weight: bold">1041</span> <span style="color: #0086f7; font-weight: bold">1093</span> <span style="color: #0086f7; font-weight: bold">1099</span> <span style="color: #0086f7; font-weight: bold">1111</span> <span style="color: #0086f7; font-weight: bold">1284</span> <span style="color: #0086f7; font-weight: bold">1344</span> <span style="color: #0086f7; font-weight: bold">1520</span> <span style="color: #0086f7; font-weight: bold">2027</span> <span style="color: #0086f7; font-weight: bold">2500</span> <span style="color: #0086f7; font-weight: bold">2734</span> <span style="color: #0086f7; font-weight: bold">3000</span> <span style="color: #0086f7; font-weight: bold">3267</span> <span style="color: #0086f7; font-weight: bold">3610</span> <span style="color: #0086f7; font-weight: bold">4285</span> <span style="color: #0086f7; font-weight: bold">5027</span><span style="color: #ffffff">)}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">t-init</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">35267</span><span style="color: #ffffff">}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">L-init</span><span style="color: #ffffff">)}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">make-array</span> <span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">t-init</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})}</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">b</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #fb660a">b</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">))</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">cpt</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span>
</pre>
      <br>
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">def</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-dynamic</span> <span style="color: #fb660a">L</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">ls</span> <span style="color: #fb660a">dyn</span> <span style="color: #fb660a">c</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; declare multiple variables</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">dyn</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dyna is a toplevel defined array</span>

  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dyna[ls t] means : 0: unknown solution, 1: solution found, 2: no solution</span>

  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">{</span><span style="color: #fb660a">dyn</span> <span style="color: #fb660a">&lt;&gt;</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; IF or WHEN : it is the same thing here (only one statement)</span>
      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">return</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one?</span> <span style="color: #fb660a">dyn</span><span style="color: #ffffff">)))</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(null? </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span>
    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">return</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">))</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">first</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">)}</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">=</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is the solution</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span>
    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">return</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">))</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">R</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">rest</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">)}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; continue searching a solution in the rest</span>

  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&gt;</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is to big to be a solution</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">s</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-dynamic</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)}</span>
    <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is part of the solution or c is not part of solution</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">s</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">subset-sum-dynamic</span> <span style="color: #fb660a">R</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">t</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">c</span><span style="color: #ffffff">})</span> <span style="color: #fb660a; font-weight: bold">or </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-dynamic</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)}})</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)}</span>
  <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return boolean value</span>
  
</pre>
    </div>
    <pre>(subset-sum-dynamic  L-init t-init)
#t
<br>
</pre>

<p style="margin-left: 40px;">Operator and function overloading:<br>
A possibility of defining overloaded functions or operators (just add
'operator) is given with this syntax:<br>
</p>
<pre>

<br>
(define (add-vect-vect v1 v2) (map + v1 v2))<br>
(overload + add-vect-vect (list? list?) 'operator)<br>
{'(1 2 3) + '(4 5 6) + '(7 8 9)}<br>
(12 15 18)<br>
<br>
(define (mult-num-vect k v) (map (λ (x) (* k x)) v))<br>
(overload * mult-num-vect (number? list?) 'operator)<br>
{3 * '(1 2 3) + '(4 5 6) + '(7 8 9)}<br>
(14 19 24)<br>

</pre>
<br>
Note that when a function that overload an operator has more than 2 args (f a1 a2 a3 ...) and only (f a1 a2) is defined
we do: (f a1 (f a2 a3 ...)) for operators.<br>
A complete set of new procedures and macros:  overload overload-procedure
overload-operator overload-function allow overloading of both
functions and operators. Those macros call procedures written
recursively because all predicate must be test to find the matching
procedure as Scheme is not a typed language.<br> 
<br>

    <p>Another example with DrRacket Scheme in the REPL (Read Eval Print
      Loop):</p>
    <p> </p>
    <img moz-do-not-send="true"
      src="Scheme+io_fichiers/racket-example.png" alt="example Racket
      scheme+ complex exponential" width="1100" height="722"><br>
    <p> </p>
    <br>
    <p>Hash Tables support :</p>
    <pre>(require Scheme-PLUS-for-Racket/Scheme+)<br><br>(require srfi/69)  ;; support for SRFI 69 Basic hash tables

{my-hash-tbl &lt;+ (make-hash-table)} ;; add an object in the current environment, here a hash table
(hash-table? my-hash-tbl)
#t
<br>{my-hash-tbl["three"] &lt;- 3}
3<br><br>{my-hash-tbl["three"]}
3

</pre>
    <p>for the rest read below and the documentation.</p>
    <br>
    <h2>2.<u>Download Scheme+:</u></h2>
    <p>The source code of <b>Scheme+</b>, for <a
        href="https://racket-lang.org/" target="_blank">Racket
        implementation of Scheme</a> can be retrieved here: </p>
    <p><br>
    </p>
    <h3 style=" text-align: center;">&gt;&gt;&gt;&nbsp;&nbsp; <a
href="https://github.com/damien-mattei/Scheme-PLUS-for-Racket/zipball/main"
        target="_blank">Download Scheme+ as .zip</a>&nbsp;&nbsp;
      &lt;&lt;&lt;<br>
    </h3>
    <p><br>
    </p>
    <h3 style=" text-align: center;">&gt;&gt;&gt;&nbsp;&nbsp; <a
href="https://github.com/damien-mattei/Scheme-PLUS-for-Racket/tarball/main"
        target="_blank">Download Scheme+ as .tar.gz</a>&nbsp;&nbsp;
      &lt;&lt;&lt;<br>
    </h3>
    <p><br>
    </p>
    <h3 style=" text-align: center;">&gt;&gt;&gt;&nbsp;&nbsp; <a
        href="https://github.com/damien-mattei/Scheme-PLUS-for-Racket"
        target="_blank">https://github.com/damien-mattei/Scheme-PLUS-for-Racket







        --&gt; Code --&gt; Download ZIP</a>&nbsp;&nbsp; &lt;&lt;&lt;<br>
    </h3>
    <p><br>
    </p>
    <p>Including : <br>
    </p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;">An implementation of the SRFI-105
      "Curly Infix" with a REPL (Read Eval Print Loop) for Racket (file
      SRFI-105.rkt).<br>
    </p>
    <p style="margin-left: 40px;">The enhanced set of LET special forms
      in the file let.scm.</p>
    <div style="margin-left: 40px;"> </div>
    <p style="margin-left: 40px;">Many of the examples of this web page
      are in the source file SssDyna.scm.</p>
    <h2><br>
    </h2>
    <h2>3<u>.Requirements:</u><br>
    </h2>
    <p>Scheme+ needs a Scheme interpreter and will be adapted and
      released for many Scheme (Guile,Racket,...), download Racket
      Scheme:<br>
    </p>
    <a href="https://racket-lang.org/" target="_blank"><img
        moz-do-not-send="true"
        src="Scheme+io_fichiers/logo-and-text-1-2.png" title="Racket
        Scheme" alt="Racket Scheme web site" width="396" border="0"
        height="120"></a><br>
    <br>
    <p>It has been developed with Racket v8.2 on <b>Mac</b><font
        color="#9999ff"><b> </b><b>OS</b></font> and Racket v7.7 under
      <b>Linux</b>.<br>
      <br>
      <br>
      <br>
    </p>
    <h2>4.<u>Author and license:</u></h2>
    <p><b>Damien Mattei </b>; <b>Scheme+</b> : Copyright 2021-2022 <b>Damien







        Mattei </b>under <a
        href="https://www.gnu.org/licenses/gpl-3.0.txt" target="_blank">GNU
































        GENERAL PUBLIC LICENSE Version 3</a></p>
    <p>Nice - France (commune de Carros) </p>
    <p> contact : firstname Dot lastname At Google Mail</p>
    <p>Guagno - Island of Corsica </p>
    <br>
    <p>To subit an issue, a bug or something else related with the
      Scheme+ code use the <a
        href="https://github.com/damien-mattei/Scheme-PLUS-for-Racket/issues"
        target="_blank" moz-do-not-send="true">Github issues system</a>.<br>
    </p>
    <p><br>
    </p>
    <h2>5.<u>Installation:</u></h2>
    <p><br>
      The easiest way to install Scheme+ for Racket is via the official
      packet manager of Racket&nbsp; : <b>File -&gt; Packet Manager</b>
      and go to tab '<b>Available from catalog</b>' and filter for '<b>Scheme+</b>'
      key word.<br>
    </p>
    <p>Other way is also from Packet manager to install the dowloaded
      package via th tab '<b>Do what i mean' -&gt; Browse -&gt;
        Directory</b> and select the directory downloaded and
      uncompressed in the section 2 of this page.</p>
    <p>Anyway you can find the Scheme+ for Racket package here: <a
        href="https://pkgs.racket-lang.org/package/Scheme-PLUS-for-Racket"
        title="Scheme+ package for Racket" target="_blank">https://pkgs.racket-lang.org/package/Scheme-PLUS-for-Racket</a>
      .<br>
    </p>
    You also need the <b>SRFI-105 Curly Infix language</b> for Racket
    and its REPL (Read Eval Print Loop) that will allow you to use infix
    notation and Scheme+.<br>
    <br>
    This is <b>mandatory</b>.<br>
    <br>
    You can find the <b>SRFI-105.rkt</b> file in the downloaded package
    of Scheme+ (in the subdirectory <b>SRFI</b>)<br>
    <br>
    <h2><u>6. Idea and rationale:</u></h2>
    <p>The core language of <a
        href="https://en.wikipedia.org/wiki/Scheme_%28programming_language%29"
        target="_blank">Scheme</a> and <a
        href="https://en.wikipedia.org/wiki/Lisp_%28programming_language%29"
        target="_blank">Lisp</a> are based on syntaxic form that date
      back from '50 for Lisp and '70 for Scheme. Syntactic forms such as
      the set of LET,LET*,LETREC,... have since long ago been replaced
      in many other languages
      (C/C++,Java,Fortran,Pascal,Javascript,BASIC (the LET keyword can
      be ommited in Applesoft Basic),by simple assignment operator that
      frees the syntax and allow saving indentation space, number of
      parenthesis, readability of code.</p>
    <p>The main idea of this project is to improve Scheme and Lisp like
      languages with syntaxic features,such as easy assignment for many
      object types (numbers,strings,vectors,arrays,etc),and also
      allowing an immediate 'return' mechanism to escape from procedure
      when result is known and others features that exist in others
      languages (Python,Java,C/C++,Pascal,BASIC,Javascript). Some new
      features can be and are better used with infix notations (<a
        href="https://srfi.schemers.org/srfi-105/srfi-105.html"
        target="_blank">SRFI 105</a> known as "Curly Infix"),so for some
      syntactic expressions infix will be promoted (but not mandatory).
    </p>
    <p>A few new feature (see below) allow a great change in syntax and
      readability of Scheme programs. Less parenthesis are used,less
      indentation and it allows an enhanced programming style that
      modernize Scheme but also keep it 100% compatible with the
      original language.</p>
    <p>Also vectors and arrays in Scheme are painfully accessed and
      modified by vector-ref and vector-set! , Scheme+ use a simplier
      syntax again with the &lt;- operator and the [] syntax.</p>
    <p>This intuitive notation works also with Hash Tables.</p>
    <p>Scheme+ will remove the need for the classic LET set of special
      form, no more need of <strike>LET,LET*,LETREC,LET-VALUES</strike>,...






      and will use an unique infix (or not) assignment operator : &lt;-.
      (also LET are enhanced - the project starts historically by improving and
      simplifying LET, i simplified it so much that i remove it now! -
      in other versions such as let&lt;-arrow requiring less brackets,
      even if their use is useless and no more promoted, see extra
      features part)</p>
    <p><br>
    </p>
    <p><br>
    </p>
    <h2><u>7. Features:</u></h2>
    <p>The list of new features is subject to change and will grow by
      time, this version allows:</p>
    <ul>
      <li>use of infix SRFI 105 "Curly Infix" for some syntax forms</li>
      <li>Assignment operator : <b>&lt;-</b> (can be used in infix
        syntax and from left to right and right to left)</li>
      <li>Square Bracket operator<b> []</b> working with Scheme <b>Vectors,







          Arrays,Multidimentional Arrays</b>,<b>Hash Tables,Strings</b>...</li>
      <li>combination of Assignment operator &lt;- with [] operator for
        Vectors,Arrays,....</li>
      <li>RETURN : <b>return</b> keyword used in any procedure to
        return from procedure and return a value.</li>
      <li>declaration of variables</li>
      <li>declaration and assignment of variables with an infix
        operator.</li>
      <li>conditionals and execution of code in a new form : condx</li>
      <li>extra feature: new set of LET special forms,even if their use
        is completely discouraged in favor of assignment operator
        combined with declarative form (see declare).</li>
    </ul>
    <h2><br>
    </h2>
    <p><br>
    </p>
    <h2><u>8. First Examples:</u></h2>
    <h3 style=" margin-left: 40px;">The <a
        href="https://en.wikipedia.org/wiki/Fibonacci_number"
        target="_blank">Fibonacci sequence</a>:</h3>
    <p style="margin-left: 40px;">This example is written in Scheme with
      and without infix notation just to allow the reader to be familiar
      with "curly infix" notation which is not part of Scheme+ but used
      by it:</p>
    <p style="margin-left: 40px;">Here is the definition in classic
      prefix Scheme:</p>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fibonacci</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">(&lt; </span><span style="color: #fb660a">n</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">)</span>
      <span style="color: #fb660a">n</span>
      <span style="color: #ffffff">(+ (</span><span style="color: #ff0086; font-weight: bold">fibonacci</span> <span style="color: #ffffff">(- </span><span style="color: #fb660a">n</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">))</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fibonacci</span> <span style="color: #ffffff">(- </span><span style="color: #fb660a">n</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">)))))</span>
</pre>
    </div>
    <p style="margin-left: 40px;">And here is a definition using "Curly
      Infix" SRFI 105:</p>
    <p style="margin-left: 40px;">
      <!-- HTML generated using hilite.me --></p>
    <div style="background: #111111; overflow:auto;width:auto;border:
      gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fib</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">&lt;</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span>
      <span style="color: #fb660a">n</span>
      <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">fib</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})</span> <span style="color: #fb660a">+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fib</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">})}</span> <span style="color: #ffffff">))</span>
</pre>
    </div>
    <p> </p>
    <br>
    <p>note that the last expression of fib: <b>{(fib {n - 1}) + (fib
        {n - 2})} </b>could also be expressed in curly infix Scheme
      like that :<b> {fib({n - 1}) + fib({n - 2})}</b> or even like
      that: <b>{fib{n - 1} + fib{n - 2}} </b>but i will not use them,
      preferring to use infix only where mathematical calculus are coded
      and for comparaison tests in conditionals.</p>
    <p>Fibonacci is time consuming,even fib(47) can takes minutes to
      compute. We will write a faster dynamic version that memorize the
      results computed more than one time.</p>
    <p>Here is a solution in classic Scheme:</p>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">size0</span> <span style="color: #0086f7; font-weight: bold">10000</span><span style="color: #ffffff">)</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">memo0</span> <span style="color: #ffffff">(make-vector </span><span style="color: #fb660a">size0</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">))</span><span style="color: #fb660a">return</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fibdyna0</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">cond </span><span style="color: #ffffff">((&lt; </span><span style="color: #fb660a">n</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">)</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)</span>
	<span style="color: #ffffff">((not (zero? (vector-ref </span><span style="color: #fb660a">memo0</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)))</span> <span style="color: #ffffff">(vector-ref </span><span style="color: #fb660a">memo0</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">))</span>
	<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">else </span><span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">let </span><span style="color: #ffffff">((</span><span style="color: #ff0086; font-weight: bold">fibn</span> <span style="color: #ffffff">(+ (</span><span style="color: #ff0086; font-weight: bold">fibdyna0</span> <span style="color: #ffffff">(- </span><span style="color: #fb660a">n</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">))</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fibdyna0</span> <span style="color: #ffffff">(- </span><span style="color: #fb660a">n</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">)))))</span>
		<span style="color: #ffffff">(vector-set! </span><span style="color: #fb660a">memo0</span> <span style="color: #fb660a">n</span> <span style="color: #fb660a">fibn</span><span style="color: #ffffff">)</span>
		<span style="color: #fb660a">fibn</span><span style="color: #ffffff">))))</span>
</pre>
    </div>
    <!-- HTML generated using hilite.me -->
    <p> </p>
    <br>
    <p>In the example above we can notice that the array access and
      modification is not easy to read and in the <b>else</b> block i
      have to use a <b>let</b> special form to create a local variable
      to return the value computed and already stored in array,even if i
      have not used a local variable i then must have to access the
      result in array to return it...</p>
    <p>Scheme+ allow to write code more readable and simpler than normal
      Scheme.</p>
    <p>Prior to use <b>Scheme+</b> for DrRacket Scheme, you must add a
      <b>#lang reader "SRFI-105.rkt" </b>directive in the first line of
      your program and the <b>module </b>must be loaded,this is done
      by inserting the statement <b>(require
        Scheme-PLUS-for-Racket/Scheme+)</b> in your program, however
      another method can be to 'require' the file : <b>(require
        "Scheme+.rkt") </b>if you have downloaded the source code.</p>
    <p>Below is the version of the above code written in Scheme+ :</p>
    <p><!-- HTML generated using hilite.me --></p>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;"><span style="color: #ffffff"></span><span
        style="color: #ffffff"><b>#lang reader "SRFI-105.rkt"<br>
        </b>(</span><span style="color: #ff0086; font-weight: bold">require






      </span><span style="color: #ffffff"></span><span style="color:
        #ff0086; font-weight: bold"><b>Scheme-PLUS-for-Racket/</b>Scheme+</span><span
        style="color: #ffffff">)<br>
      </span> </div>
    <div style="background: #111111; overflow:auto;width:auto;border:
      gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">{</span><span style="color: #fb660a">size</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #0086f7; font-weight: bold">10000</span><span style="color: #ffffff">}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">memo</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(make-vector </span><span style="color: #fb660a">size</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">)}</span> 
  
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fibdyna</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">cond </span><span style="color: #ffffff">({</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">&lt;</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)</span>
	<span style="color: #ffffff">({</span><span style="color: #fb660a">memo</span><span style="color: #ffffff">[</span><span style="color: #fb660a">n</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;&gt;</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">memo</span><span style="color: #ffffff">[</span><span style="color: #fb660a">n</span><span style="color: #ffffff">]})</span>                
	<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">else </span><span style="color: #ffffff">{</span><span style="color: #fb660a">memo</span><span style="color: #ffffff">[</span><span style="color: #fb660a">n</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">fibdyna</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})</span> <span style="color: #fb660a">+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fibdyna</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">})}})</span> <span style="color: #ffffff">))</span>
</pre>
    </div>
    <p> </p>
    <br>
    <p>The reader can notice the introduction of one new assignment
      operator <b>&lt;-</b> and also <b>&lt;+</b>, the latter being
      simply an infix <b>define</b> of Scheme. The important point of
      the new assignment operator <b>&lt;-</b> of <b>Scheme+</b> is
      that it will work like the classic <b>set! </b>of Scheme on
      variables but also will work on more <b>complex object such as
        element of vectors,multidimensional arrays (as defined in
        SRFIs),... and much more in the next versions of Scheme+</b>.
      (we will see another more complex example with multidimentional
      array later)</p>
    <p>So <b>{x &lt;- 7} </b>simply assign 7 to the variable x but <b>{m[3]







        &lt;- 7}</b> will store 7 in the array <b>m </b>at the
      position indexed by 3. Access an element of array is also simpler
      in Scheme+ than in Scheme: <b>{m[3]}</b>. And this syntax is 100%
      compatible with Scheme, you can mix both the syntaxes if you want.
      This syntax is also more natural and readable and much like the
      mathematical notation, it is also a syntax used for arrays in
      other languages such as C/C++,Python,Java,Pascal,Javascript...</p>
    <p>Also you will notice&nbsp; that the main computation in the <b>else</b>
      block is now shorter and it is partly due to the fact that the
      assignment operator <b>&lt;- </b>return not NIL but the affected
      <b>value</b> making it available for other calculus or as a final
      result value.</p>
    <p>Here is now the same solution in a declarative form, in the
      part&nbsp; called "History of project" i explain why there exist
      two solutions. </p>
    <p>Instead of declare and assign the variables with the <b>define</b>
      nested in the <b>macro &lt;+ </b>we also can <b>declare</b>
      them and assign the variables later with the universal <b>&lt;-</b>
      operator:</p>
    <h2> </h2>
    <div id="preview">
      <p> <strong><br>
        </strong> </p>
      <div style="background: #111111;
        overflow:auto;width:auto;border:solid gray;border-width:.1em
        .1em .1em .8em;padding:.2em .6em;">
        <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff"><span style="color: #ffffff"><b>#lang reader "SRFI-105.rkt"<br></b>(</span><span style="color: #ff0086; font-weight: bold">require </span><span style="color: #ffffff"></span><span style="color: #ff0086;
        font-weight: bold"><b>Scheme-PLUS-for-Racket/</b>Scheme+</span><span style="color: #ffffff">)<br>
</span></span><span style="color: #ff0086; font-weight: bold"></span><span style="color: #ffffff"></span><span style="color: #ff0086; font-weight: bold"></span><span style="color: #ffffff"></span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">size1</span> <span style="color: #fb660a">memo1</span><span style="color: #ffffff">)</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">size1</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">10000</span><span style="color: #ffffff">}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">memo1</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(make-vector </span><span style="color: #fb660a">size</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">)}</span> 
  
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fibdyna1</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">cond </span><span style="color: #ffffff">({</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">&lt;</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">n</span><span style="color: #ffffff">)</span>
	<span style="color: #ffffff">({</span><span style="color: #fb660a">memo1</span><span style="color: #ffffff">[</span><span style="color: #fb660a">n</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;&gt;</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">memo1</span><span style="color: #ffffff">[</span><span style="color: #fb660a">n</span><span style="color: #ffffff">]})</span>
	<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">else </span><span style="color: #ffffff">{</span><span style="color: #fb660a">memo1</span><span style="color: #ffffff">[</span><span style="color: #fb660a">n</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">fibdyna1</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})</span> <span style="color: #fb660a">+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fibdyna1</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">})}})</span> <span style="color: #ffffff">))</span>
</pre>
      </div>
    </div>
    <h2> </h2>
    <h2><br>
    </h2>
    <p><br>
    </p>
    <h2><u>9.Short documentation</u></h2>
    <p>Square bracket operator <b>[] </b>is used for
      vectors,arrays,hash tables,etc.</p>
    <p>example: <b>{T[k]} </b>return value of vector or array T
      indexed by k.</p>
    <p><br>
    </p>
    <p>Assignment operator <b>&lt;- </b>can be used only on existing
      single variables or vector,arrays,etc . Note that vector and
      arrays must be defined the usual way they are in Scheme. The
      operator &lt;- works also with multidimensional arrays.</p>
    <p>examples : </p>
    <ol>
      <li><b>{x &lt;- 7} </b></li>
      <li><b>{x &lt;- y} </b></li>
      <li><b>{m[3] &lt;- 7}</b></li>
      <li><b>{T</b><b>[k] &lt;- x}</b></li>
      <li><b>{T</b><b>[k] &lt;- </b><b><b>T</b><b>[k + 1]</b>}</b></li>
      <li><b><b>{</b>T</b><b>[m n] &lt;- </b><b><b>T</b><b>[m {n + 1}]</b>}</b></li>
      <li><b>{my-hash-tbl["three"] &lt;- 3}</b></li>
    </ol>
    <p><br>
    </p>
    <p>Definition and assignment of variables is made with the <b>&lt;+</b>
      operator but can also be done with the classic Scheme <b>define</b>.</p>
    <p>example: {size &lt;+ 1000}</p>
    <p><br>
    </p>
    <p>Declaration of variable can also be used to <b>declare</b> one
      or many variables. (for explanation why there exist still <b>&lt;+</b>
      and <b>declare</b> and not only <b>&lt;-</b> read the part
      history of project)</p>
    <p>example: <b>(declare x y z t)</b></p>
    <p> </p>
    <p> </p>
    <br>
    <p><u>How to load a Scheme+ program:</u></p>
    <p>Scheme+ programs are loaded this way in Racket and must have a <b>(provide









        (all-defined-out))</b> to export all bindings:</p>
    <pre>(require "logiki+.rkt")<br><br>(infix-symb-min-dnf '{{(not a) and (not b) and (not c) and (not d)} or {(not a) and (not b) and (not c) and d} or {(not a) and (not b) and c and (not d)} or {(not a) and b and (not c) and d} or {(not a) and b and c and (not d)} or {(not a) and b and c and d} or {a and (not b) and (not c) and (not d)} or {a and (not b) and (not c) and d} or {a and (not b) and c and (not d)} or {c and (not d)}} )
disj-norm-form = (or (and c (not d)) (and (not a) (not b) (not c) (not d)) (and (not a) (not b) (not c) d) (and (not a) b (not c) d) (and (not a) b c d) (and a (not b) (not c) (not d)) (and a (not b) (not c) d))
<br>'((¬b ∧ ¬c) ∨ (c ∧ ¬d) ∨ (¬a ∧ b ∧ d))</pre>
    <p>We can use a convention to name the Scheme+ programs and function
      with a + at end, keeping the .scm extension unchanged for
      compatibility.<br>
    </p>
    <p><br>
    </p>
    <h2>10<u>.Advanced examples:</u><br>
    </h2>
    <p>Here is another example, from the <a
href="https://en.wikipedia.org/wiki/Subset_sum_problem#Pseudo-polynomial_time_dynamic_programming_solution"
        target="_blank">Subset Sum Problem</a> that show the use of <b>&lt;+</b>
      and <b>&lt;-</b> (due to the impossibility to have easily a
      single operator :-( ) :</p>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;"><span style="color: #ffffff">#lang
        reader "../SRFI/SRFI-105.rkt"<br>
        ;;(require "../Scheme+.rkt")<br>
        (require Scheme-PLUS-for-Racket/Scheme+)<br>
      </span><span style="color: #ff0086; font-weight: bold"></span><span
        style="color: #ffffff"></span><span style="color: #ff0086;
        font-weight: bold"></span><span style="color: #ffffff"></span> </div>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">{</span><span style="color: #fb660a">L-init</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">'(</span><span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086f7; font-weight: bold">3</span> <span style="color: #0086f7; font-weight: bold">4</span> <span style="color: #0086f7; font-weight: bold">16</span> <span style="color: #0086f7; font-weight: bold">17</span> <span style="color: #0086f7; font-weight: bold">24</span> <span style="color: #0086f7; font-weight: bold">45</span> <span style="color: #0086f7; font-weight: bold">64</span> <span style="color: #0086f7; font-weight: bold">197</span> <span style="color: #0086f7; font-weight: bold">256</span> <span style="color: #0086f7; font-weight: bold">275</span> <span style="color: #0086f7; font-weight: bold">323</span> <span style="color: #0086f7; font-weight: bold">540</span> <span style="color: #0086f7; font-weight: bold">723</span> <span style="color: #0086f7; font-weight: bold">889</span> <span style="color: #0086f7; font-weight: bold">915</span> <span style="color: #0086f7; font-weight: bold">1040</span> <span style="color: #0086f7; font-weight: bold">1041</span> <span style="color: #0086f7; font-weight: bold">1093</span> <span style="color: #0086f7; font-weight: bold">1099</span> <span style="color: #0086f7; font-weight: bold">1111</span> <span style="color: #0086f7; font-weight: bold">1284</span> <span style="color: #0086f7; font-weight: bold">1344</span> <span style="color: #0086f7; font-weight: bold">1520</span> <span style="color: #0086f7; font-weight: bold">2027</span> <span style="color: #0086f7; font-weight: bold">2500</span> <span style="color: #0086f7; font-weight: bold">2734</span> <span style="color: #0086f7; font-weight: bold">3000</span> <span style="color: #0086f7; font-weight: bold">3267</span> <span style="color: #0086f7; font-weight: bold">3610</span> <span style="color: #0086f7; font-weight: bold">4285</span> <span style="color: #0086f7; font-weight: bold">5027</span><span style="color: #ffffff">)}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">t-init</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #0086f7; font-weight: bold">35267</span><span style="color: #ffffff">}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">L-init</span><span style="color: #ffffff">)}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">make-array</span> <span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">t-init</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})}</span>
</pre>
    </div>
    <div style="background: #111111; overflow:auto;width:auto;border:
      gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">{</span><span style="color: #fb660a">cpt</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; define cpt to 0</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-guile</span> <span style="color: #fb660a">L</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">dyn</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]}</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">cpt</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">cpt</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; cpt has been already defined at toplevel</span>
  
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dyna[ls t] means 0: unknown solution, 1: solution found, 2: no solution</span>
  
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">condx</span> <span style="color: #ffffff">[{</span><span style="color: #fb660a">dyn</span> <span style="color: #fb660a">&lt;&gt;</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one?</span> <span style="color: #fb660a">dyn</span><span style="color: #ffffff">)]</span>
	 <span style="color: #ffffff">[(null? </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span>  <span style="color: #0086d2">#f</span><span style="color: #ffffff">]</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return #f</span>
	 
	 <span style="color: #ffffff">[</span><span style="color: #fb660a">exec</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">first</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">)}]</span>	 
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is the solution</span>
	 <span style="color: #ffffff">[{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">=</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span>  <span style="color: #0086d2">#t</span><span style="color: #ffffff">]</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return #t</span>
	 
	 <span style="color: #ffffff">[</span><span style="color: #fb660a">exec</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">R</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">rest</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">)}]</span>	 
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; continue searching a solution in the rest</span>
	 <span style="color: #ffffff">[{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&gt;</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">s</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-guile</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)}</span>
	          <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)}</span>
		  <span style="color: #fb660a">s</span><span style="color: #ffffff">]</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return boolean value</span>
			
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; else : c &lt; t at this point</span>
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is part of a solution OR not part of a solution</span>
	 <span style="color: #ffffff">[</span><span style="color: #fb660a; font-weight: bold">else </span><span style="color: #ffffff">{</span><span style="color: #fb660a">s</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">subset-sum-guile</span> <span style="color: #fb660a">R</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">t</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">c</span><span style="color: #ffffff">})</span> <span style="color: #fb660a; font-weight: bold">or </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-guile</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)}}</span>
	       <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)}</span>
	       <span style="color: #fb660a">s</span><span style="color: #ffffff">]))</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return boolean value</span>
</pre>
    </div>
    <p> </p>
    <br>
    <p><b>(subset-sum-guile&nbsp; L-init t-init)</b></p>
    <p><b>#t</b><br>
      <br>
    </p>
    <p style="text-align: center;">note: in the example above condx is a
      macro that allow execution of arbitrary code between conditionals
      clauses,general syntax is:</p>
    <p style="text-align: left; margin-left: 40px;">(<b>condx </b>[<i>condition







        statements </i>...]</p>
    <div style="margin-left: 40px;"> </div>
    <p style="text-align: left; margin-left: 40px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;









































      [<b>exec</b><i> statements ... </i>]</p>
    <div style="margin-left: 40px;"> </div>
    <p style="text-align: left; margin-left: 40px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;









































      ...</p>
    <div style="margin-left: 40px;"> </div>
    <p style="text-align: left; margin-left: 40px;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;









































      [<b>else </b><i>statements</i> ...])</p>
    <div style="margin-left: 40px;"> </div>
    <p style="text-align: center;"><br>
    </p>
    <p style="text-align: left;">In classic Scheme the code would be
      like that which is longer than in Scheme+:</p>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">cpt</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">)</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">ssigma-proto</span> <span style="color: #fb660a">L</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span>

  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">set! </span><span style="color: #fb660a">cpt</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">cpt</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})</span>
 
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">ls</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">L</span><span style="color: #ffffff">))</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">dyn</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">array-ref</span> <span style="color: #fb660a">dyna</span> <span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">))</span>
    
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dyna[ls][t] means 0: unknown solution, 1: solution found, 2: no solution</span>

  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">cond </span><span style="color: #ffffff">[(not (zero? </span><span style="color: #fb660a">dyn</span><span style="color: #ffffff">))</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one?</span> <span style="color: #fb660a">dyn</span><span style="color: #ffffff">)]</span>
	<span style="color: #ffffff">[(null? </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">array-set!</span> <span style="color: #fb660a">dyna</span> <span style="color: #0086f7; font-weight: bold">2</span> <span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">]</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return #f</span>
	
	<span style="color: #ffffff">[</span><span style="color: #fb660a; font-weight: bold">else </span><span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">let </span><span style="color: #ffffff">[(</span><span style="color: #ff0086; font-weight: bold">c</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">first</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">))]</span>
		
		<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">=</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is the solution</span>
		      
		    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">begin</span>
		      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">array-set!</span> <span style="color: #fb660a">dyna</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span>
		      <span style="color: #0086d2">#t</span><span style="color: #ffffff">)</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return #t</span>

		    <span style="color: #008800; font-style: italic; background-color: #0f140f">;; else</span>
		    <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">let </span><span style="color: #ffffff">[(</span><span style="color: #ff0086; font-weight: bold">R</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">rest</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">))]</span>
		      
		      <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&gt;</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span>   <span style="color: #008800; font-style: italic; background-color: #0f140f">;; continue searching a solution in the rest</span>
			    
			  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">let </span><span style="color: #ffffff">[(</span><span style="color: #ff0086; font-weight: bold">s</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">ssigma-proto</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">))]</span>
			    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">array-set!</span> <span style="color: #fb660a">dyna</span>
					<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span>
					<span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span>
			      
			    <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return s</span>
			
			  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; else</span>
			  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c &lt; t at this point</span>
			  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is part of the solution or his approximation</span>
			  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; or c is not part of solution</span>
			  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">let </span><span style="color: #ffffff">[(</span><span style="color: #ff0086; font-weight: bold">s</span> <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">ssigma-proto</span> <span style="color: #fb660a">R</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">t</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">c</span><span style="color: #ffffff">})</span> <span style="color: #fb660a; font-weight: bold">or </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">ssigma-proto</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)})]</span>
			    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">array-set!</span> <span style="color: #fb660a">dyna</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span>
					<span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span>
			    <span style="color: #fb660a">s</span><span style="color: #ffffff">)))))</span>
	      <span style="color: #ffffff">]</span> <span style="color: #ffffff">))</span>
</pre>
    </div>
    <p style="text-align: left;"> <br>
    </p>
    <p style="text-align: left;"><br>
    </p>
    <p style="text-align: left;">If you want to use a single assignment
      operator <b>&lt;-</b> it is possible using a declarative
      programming style with the <b>declare </b>macro:</p>
    <p> </p>
    <p><!-- HTML generated using hilite.me --> </p>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">#lang reader "../SRFI/SRFI-105.rkt"<br>;;(require "../Scheme+.rkt")<br>(require Scheme-PLUS-for-Racket/Scheme+)</span>
</pre>
    </div>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">L-init</span> <span style="color: #fb660a">t-init</span> <span style="color: #fb660a">ls</span> <span style="color: #fb660a">dyna</span> <span style="color: #fb660a">cpt</span><span style="color: #ffffff">)</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">L-init</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">'(</span><span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086f7; font-weight: bold">3</span> <span style="color: #0086f7; font-weight: bold">4</span> <span style="color: #0086f7; font-weight: bold">16</span> <span style="color: #0086f7; font-weight: bold">17</span> <span style="color: #0086f7; font-weight: bold">24</span> <span style="color: #0086f7; font-weight: bold">45</span> <span style="color: #0086f7; font-weight: bold">64</span> <span style="color: #0086f7; font-weight: bold">197</span> <span style="color: #0086f7; font-weight: bold">256</span> <span style="color: #0086f7; font-weight: bold">275</span> <span style="color: #0086f7; font-weight: bold">323</span> <span style="color: #0086f7; font-weight: bold">540</span> <span style="color: #0086f7; font-weight: bold">723</span> <span style="color: #0086f7; font-weight: bold">889</span> <span style="color: #0086f7; font-weight: bold">915</span> <span style="color: #0086f7; font-weight: bold">1040</span> <span style="color: #0086f7; font-weight: bold">1041</span> <span style="color: #0086f7; font-weight: bold">1093</span> <span style="color: #0086f7; font-weight: bold">1099</span> <span style="color: #0086f7; font-weight: bold">1111</span> <span style="color: #0086f7; font-weight: bold">1284</span> <span style="color: #0086f7; font-weight: bold">1344</span> <span style="color: #0086f7; font-weight: bold">1520</span> <span style="color: #0086f7; font-weight: bold">2027</span> <span style="color: #0086f7; font-weight: bold">2500</span> <span style="color: #0086f7; font-weight: bold">2734</span> <span style="color: #0086f7; font-weight: bold">3000</span> <span style="color: #0086f7; font-weight: bold">3267</span> <span style="color: #0086f7; font-weight: bold">3610</span> <span style="color: #0086f7; font-weight: bold">4285</span> <span style="color: #0086f7; font-weight: bold">5027</span><span style="color: #ffffff">)}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">t-init</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">35267</span><span style="color: #ffffff">}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">L-init</span><span style="color: #ffffff">)}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">make-array</span> <span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">t-init</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})}</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">b</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #fb660a">b</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">))</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">cpt</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span>
</pre>
    </div>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-guile-dec</span> <span style="color: #fb660a">L</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">ls</span> <span style="color: #fb660a">dyn</span> <span style="color: #fb660a">c</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span>
  
  <span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">dyn</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]}</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">cpt</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">cpt</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; cpt has been already defined at toplevel</span>
  
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dyna[ls t] means 0: unknown solution, 1: solution found, 2: no solution</span>
  
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">condx</span> <span style="color: #ffffff">[{</span><span style="color: #fb660a">dyn</span> <span style="color: #fb660a">&lt;&gt;</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one?</span> <span style="color: #fb660a">dyn</span><span style="color: #ffffff">)]</span>
	 <span style="color: #ffffff">[(null? </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span>  <span style="color: #0086d2">#f</span><span style="color: #ffffff">]</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return #f</span>
	 
	 <span style="color: #ffffff">[</span><span style="color: #fb660a">exec</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">first</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">)}]</span>	 
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is the solution</span>
	 <span style="color: #ffffff">[{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">=</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span>  <span style="color: #0086d2">#t</span><span style="color: #ffffff">]</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return #t</span>
	 
	 <span style="color: #ffffff">[</span><span style="color: #fb660a">exec</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">R</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">rest</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">)}]</span>	 
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; continue searching a solution in the rest</span>
	 <span style="color: #ffffff">[{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&gt;</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">s</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-guile-dec</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)}</span>
	          <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)}</span>
		  <span style="color: #fb660a">s</span><span style="color: #ffffff">]</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return boolean value</span>
			
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; else : c &lt; t at this point</span>
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is part of a solution OR not part of a solution</span>
	 <span style="color: #ffffff">[</span><span style="color: #fb660a; font-weight: bold">else </span><span style="color: #ffffff">{</span><span style="color: #fb660a">s</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">subset-sum-guile-dec</span> <span style="color: #fb660a">R</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">t</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">c</span><span style="color: #ffffff">})</span> <span style="color: #fb660a; font-weight: bold">or </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-guile-dec</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)}}</span>
	       <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)}</span>
	       <span style="color: #fb660a">s</span><span style="color: #ffffff">]))</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return boolean value</span>
</pre>
    </div>
    <p style="text-align: left;">It is also possible to use <b>return</b>
      keyword in function definition by <b>def </b>macro and have
      again another programming style with <b>if then else</b> that
      looks like traditionals language such as
      Python,Javascript,C/C++,etc... :</p>
    <p style="text-align: left;">This example mix many Scheme+ Style and
      illustrate the use of <b>return </b>in a Python/C++ style:</p>
    <p style="text-align: left;"><br>
    </p>
    <!-- HTML generated using hilite.me -->
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff"></span><span style="color: #ff0086; font-weight: bold"></span><span style="color: #ffffff"></span><span style="color: #ff0086; font-weight: bold"></span><span style="color: #ffffff"></span><span style="color: #ffffff">#lang reader "../SRFI/SRFI-105.rkt"<br>;;(require "../Scheme+.rkt")<br>(require Scheme-PLUS-for-Racket/Scheme+)</span>
</pre>
    </div>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #fb660a">def</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-dyna</span> <span style="color: #fb660a">L</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">ls</span> <span style="color: #fb660a">dyn</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; declare multiple variables</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">dyn</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]}</span>

  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dyna[ls t] means : 0: unknown solution, 1: solution found, 2: no solution</span>

  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">{</span><span style="color: #fb660a">dyn</span> <span style="color: #fb660a">&lt;&gt;</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; IF or WHEN : it is the same thing here (only one statement)</span>
      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">return</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one?</span> <span style="color: #fb660a">dyn</span><span style="color: #ffffff">)))</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(null? </span><span style="color: #fb660a">L</span><span style="color: #ffffff">)</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span>
    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">return</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">))</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">first</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">)}</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">=</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is the solution</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span>
    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">return</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">))</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">R</span> <span style="color: #fb660a">&lt;+</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">rest</span> <span style="color: #fb660a">L</span><span style="color: #ffffff">)}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; continue searching a solution in the rest</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">{</span><span style="color: #fb660a">c</span> <span style="color: #fb660a">&gt;</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">}</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is to big to be a solution</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">s</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-dyna</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)}</span>
    <span style="color: #008800; font-style: italic; background-color: #0f140f">;; c is part of the solution or c is not part of solution</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">s</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">subset-sum-dyna</span> <span style="color: #fb660a">R</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">t</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">c</span><span style="color: #ffffff">})</span> <span style="color: #fb660a; font-weight: bold">or </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">subset-sum-dyna</span> <span style="color: #fb660a">R</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">)}})</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">dyna</span><span style="color: #ffffff">[</span><span style="color: #fb660a">ls</span> <span style="color: #fb660a">t</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">one-two</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)}</span>
  <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; return boolean value</span>
</pre>
    </div>
    <h2><br>
    </h2>
    <h2><br>
    </h2>
    <h2>11<u>. History of project:</u></h2>
    <p>First i developped a new set of LET special forms with less
      bracket use and after i decided to use another assignment scheme
      based on infix operator for a little part,at some point the new
      assignment scheme was became so perfect that we no more need the
      set of LET special forms.But i also released the new set of LET
      special forms even if i consider those useless.Unfornunately
      Scheme do not allow to use only a single assignment operator
      because&nbsp; of declaration (define) of variables and set! are
      different and it does not exist a define-or-set! function. So i
      only had the choice to use 2 assignment operators, one acting as <b>define</b>
      (<b>&lt;+</b>) and the other as <b>set!</b> (<b>&lt;-</b>) or a
      single assignment operator <b>&lt;- </b>and a declarative macro
      called <b>declare</b> which should be interesting for typed
      Scheme implementations too.</p>
    <p><br>
    </p>
    <p><br>
    </p>
    <p><br>
    </p>
    <h2>12.<u>Additional documentation:</u></h2>
    <p><b>condx</b> is a macro that allow execution of arbitrary code
      between conditionals clauses,syntax is :</p>
    <p>(<b>condx </b>[<i>condition statements </i>...] </p>
    <p style="text-align: left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;









































      [<b>exec</b><i> statements ... </i>]</p>
    <p style="text-align: left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;









































      ...</p>
    <p style="text-align: left;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;









































      [<b>else </b><i>statements</i> ...])</p>
    <p style="text-align: left;"><b>condx</b> is not a major feature of
      <b>Scheme+</b> but it can replace a lot of 'if then <b>elif'</b>,
      i dislike and still misunderstand sometimes, '<b>else if</b>'
      since BASIC !<br>
    </p>
    <p style="text-align: left;">&nbsp;<br>
    </p>
    <p style="text-align: left;">defining new functions with <b>def </b>instead









































      of the classic define we can now use <b>return</b> to escape
      immediately returning the value v:</p>
    <p style="text-align: left;"><b>(return </b>v<b>) </b><b> </b></p>
    <p style="text-align: left;"><br>
    </p>
    <p style="text-align: left;"><b>$ </b>is a macro, it is a shortcut
      for <b>begin.<br>
      </b></p>
    <p style="text-align: left;">But <b>begin</b> is dual in Scheme, it
      expands differently in <i>expression </i>context and <i>definition






      </i>context. See this for more information:</p>
    <p style="text-align: left;"><a
        href="https://www.gnu.org/software/guile/manual/html_node/begin.html"
        moz-do-not-send="true">https://www.gnu.org/software/guile/manual/html_node/begin.html</a><br>
    </p>
    <p style="text-align: left;">For this reason it is sometimes
      necessary to use a classic <b>let </b>to create a block,for
      example when defining a <i>clozure.<br>
      </i></p>
    <p style="text-align: left;">As example consider those two
      definitions where the first - foo - is erroneous:<br>
    </p>
    <!-- HTML generated using hilite.me -->
    <div style="background: #f8f8f8;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%">(<span style="color: #AA22FF; font-weight: bold">define </span><span style="color: #B8860B">foo</span> (<span style="color: #AA22FF; font-weight: bold">begin </span>(<span style="color: #AA22FF; font-weight: bold">define </span><span style="color: #B8860B">x</span> <span style="color: #666666">1</span>)
                   (<span style="color: #AA22FF; font-weight: bold">define </span><span style="color: #B8860B">y</span> <span style="color: #666666">2</span>)
                   (<span style="color: #AA22FF; font-weight: bold">λ </span>(<span style="color: #00A000">t</span>) (<span style="color: #AA22FF">+ </span><span style="color: #B8860B">x</span> <span style="color: #B8860B">y</span> <span style="color: #B8860B">t</span>))))

(<span style="color: #AA22FF; font-weight: bold">define </span><span style="color: #B8860B">bar</span> (<span style="color: #AA22FF; font-weight: bold">let </span>()
              (<span style="color: #AA22FF; font-weight: bold">define </span><span style="color: #B8860B">x</span> <span style="color: #666666">1</span>)
              (<span style="color: #AA22FF; font-weight: bold">define </span><span style="color: #B8860B">y</span> <span style="color: #666666">2</span>)
              (<span style="color: #AA22FF; font-weight: bold">λ </span>(<span style="color: #00A000">t</span>) (<span style="color: #AA22FF">+ </span><span style="color: #B8860B">x</span> <span style="color: #B8860B">y</span> <span style="color: #B8860B">t</span>))))
</pre>
    </div>
    <p style="text-align: left;">error: define: not allowed in an
      expression context in: (define x 1)<br>
    </p>
    <p style="text-align: left;">for this reason i provide a <b>&amp; </b>macro





























      that is defined with a <b>let </b>as this:<br>
    </p>
    <p style="text-align: left;"> </p>
    <pre style="margin: 0; line-height: 125%">(<span style="color: #AA22FF; font-weight: bold">define-syntax </span><span style="color: #B8860B">&amp;</span>
  (<span style="color: #AA22FF; font-weight: bold">syntax-rules </span>()
    ((<span style="color: #00A000">_</span> <span style="color: #B8860B">ev</span>)  <span style="color: #B8860B">ev</span>)
    ((<span style="color: #00A000">_</span> <span style="color: #B8860B">ev</span> <span style="color: #666666">...</span>) (<span style="color: #AA22FF; font-weight: bold">let </span>() <span style="color: #B8860B">ev</span> <span style="color: #666666">...</span>))))
</pre>
    <p>We can now define the previous bar function in Scheme+ like this:<br>
    </p>
    <p> </p>
    <div id="highlight-preview">
      <pre class="scheme" style="font-family:monospace;"><span style="color: #006600;">(</span>def bar <span style="color: #006600;">(</span><span style="color: #006600;">&amp;</span> <span style="color: #006600;">(</span>declare x y<span style="color: #006600;">)</span>
            <span style="color: #006600;">{</span>x <span style="color: #006600;">&lt;-</span> <span style="color: #cc66cc;">1</span><span style="color: #006600;">}</span> 
            <span style="color: #006600;">{</span>y <span style="color: #006600;">&lt;-</span> <span style="color: #cc66cc;">2</span><span style="color: #006600;">}</span>
            <span style="color: #006600;">(</span><span style="color: #b1b100;">λ</span> <span style="color: #006600;">(</span><span style="color: #b1b100;">t</span><span style="color: #006600;">)</span> <span style="color: #006600;">(</span><span style="color: #006600;">+</span> x y <span style="color: #b1b100;">t</span><span style="color: #006600;">)</span><span style="color: #006600;">)</span><span style="color: #006600;">)</span><span style="color: #006600;">)<br><br></span><span style="color: #006600;"></span></pre>
      <pre>(bar 7)<br>10</pre>
    </div>
    <p style="text-align: left;"> </p>
    <h2 style=" text-align: left;">13.<u>Caveats:</u></h2>
    <p>Inherent to Scheme language it as not been possible to simplify
      more assignment operator in a single one case. This is due to the
      fact that it can not be written a macro that do define-or-set! and
      that define can not be placed any where. See discussion in <a
href="https://lists.gnu.org/archive/html/guile-devel/2021-09/msg00031.html"
        target="_blank">Guile devel mailing list archive in September
        2021</a> For the place of define, by chance,some Scheme
      implementation allow define to be placed almost anywhere.</p>
    <p><br>
    </p>
    <p><br>
    </p>
    <h2>14.<u>Implementation:</u></h2>
    <p>Mainly with <b>Scheme macros</b> which are not recursive (except
      in some obsolete features),so expansion is fast and code also. It
      also allows a great portabilty from one Scheme implementation to
      another one.</p>
    <p><br>
    </p>
    <p><br>
    </p>
    <h2>15.<u>Future:</u></h2>
    <p>Scheme+ will continue to be implemented for other Scheme
      implementations.</p>
    <p><br>
    </p>
    <h2><u>16.Extra features:</u> </h2>
    <br>
    <p>Other features include a part of my personal functional library
      when functions are not existing already in some <a
        href="https://srfi.schemers.org/" target="_blank">SRFI (Scheme
        Request For Implementations)</a>.</p>
    <p><br>
    </p>
    <p><br>
    </p>
    <h2>17.<u>Obsolete features:</u></h2>
    <p>As mentioned early the project idea was initially to enhance the
      set of LET special form. The use of the LET set is no more need
      with the new assignment operator but i release anyway those set of
      enhanced and simplified LETs, i just give some examples as names
      are self-explanatory.</p>
    <p>The way to be able to use the new set of LET special form is to
      load the file let.scm which is available in the Scheme+ directory:</p>
    <p><b>(load "let.scm")</b></p>
    <p>Examples:</p>
    <p><!-- HTML generated using hilite.me --></p>
    <div style="background: #272822;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">(</span><span style="color: #a6e22e">let&lt;-rec*</span> <span style="color: #f8f8f2">[x</span> <span style="color: #f8f8f2">&lt;-</span> <span style="color: #ae81ff">1</span>
            <span style="color: #f8f8f2">y</span> <span style="color: #f8f8f2">&lt;-</span> <span style="color: #f8f8f2">(+ x</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">)</span>
            <span style="color: #f8f8f2">z</span> <span style="color: #f8f8f2">&lt;-</span> <span style="color: #f8f8f2">(+ </span><span style="color: #ae81ff">2</span> <span style="color: #f8f8f2">y)]</span>
         <span style="color: #f8f8f2">z)</span>
<span style="color: #ae81ff">4</span>
</pre>
    </div>
    <br>
    <p>a few others special forms simplifying the LETs (but still
      obsolete in my opinion):</p>
    <p>let-arrow* :</p>
    <p><!-- HTML generated using hilite.me --></p>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">let-arrow*</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">x</span> <span style="color: #ffffff">←</span> <span style="color: #0086f7; font-weight: bold">1</span>
 	     <span style="color: #fb660a">y</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})</span>
           <span style="color: #fb660a">y</span><span style="color: #ffffff">)</span>
<span style="color: #0086f7; font-weight: bold">2</span>
</pre>
    </div>
    <p> </p>
    <p><!-- HTML generated using hilite.me --></p>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">let-arrow*</span> <span style="color: #ffffff">({</span><span style="color: #fb660a">x</span> <span style="color: #ffffff">←</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span>
             <span style="color: #ffffff">{</span><span style="color: #fb660a">y</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}})</span>
           <span style="color: #fb660a">x</span>
           <span style="color: #fb660a">y</span><span style="color: #ffffff">)</span>

<span style="color: #0086f7; font-weight: bold">2</span>
</pre>
    </div>
    <p> </p>
    <p><!-- HTML generated using hilite.me --></p>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">let-arrow*</span> <span style="color: #ffffff">[</span> <span style="color: #fb660a">x</span> <span style="color: #0086f7; font-weight: bold">1</span>
              <span style="color: #fb660a">y</span> <span style="color: #ffffff">(+ </span><span style="color: #fb660a">x</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">)</span>
              <span style="color: #fb660a">z</span> <span style="color: #ffffff">(+ </span><span style="color: #0086f7; font-weight: bold">2</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">]</span>
            <span style="color: #fb660a">z</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">)</span>

<span style="color: #0086f7; font-weight: bold">2</span>
</pre>
    </div>
    <p> </p>
    <p><br>
    </p>
    <p>letrec-arrow* , the same as let-arrow* but for recursive
      functions:</p>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">letrec-arrow*</span> <span style="color: #ffffff">[</span> <span style="color: #fb660a">fact</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">λ </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">n</span><span style="color: #ffffff">)</span>
 			  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">=</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span>
 			       <span style="color: #0086f7; font-weight: bold">1</span>
                               <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">*</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fact</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">})}</span> <span style="color: #ffffff">))</span> <span style="color: #ffffff">]</span>
 	       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">fact</span> <span style="color: #0086f7; font-weight: bold">5</span><span style="color: #ffffff">))</span>

<span style="color: #0086f7; font-weight: bold">120</span>
</pre>
    </div>
    <br>
    <h2><br>
    </h2>
    <h2><u>18.Comments:</u></h2>
    <p>Github web site technology force me to convert this page in
      Github Markup Language, perheaps instead of HTML should i have
      make it directly in GML but i did not know it existed before doing
      it. I did not want to make this documentation so long and
      graphically complex to set up. Well it's done! <i><b>i hope you
          get interest in reading at least 10% :-)</b></i> . And get as
      pleasure to read and use than i take making and writing it.<br>
      <b>This documentation is at end and it is quite impressive how
        long it takes to document things! </b>Even if i suppose&nbsp; i
      could have forget&nbsp; things to talk about.<br>
    </p>
    <p><br>
    </p>
    <h2>19. <u>Special characters (for special people):</u></h2>
    <p>This is about the optional replacement symbols for some
      operators:</p>
    <br>
    <br>
    <p>The hexadécimal unicode can be entered under Linux with :
      Ctrl-Shift u following with the hexadecimal unicode and Enter or
      Space bar, on <a
href="https://apple.stackexchange.com/questions/183045/how-can-i-type-unicode-characters-without-using-the-mouse"
        moz-do-not-send="true">Mac OS use </a> <a
href="https://apple.stackexchange.com/questions/183045/how-can-i-type-unicode-characters-without-using-the-mouse"
        moz-do-not-send="true">CTRL+CMD+space to bring up the characters
        popover, </a> <a
href="https://apple.stackexchange.com/questions/183045/how-can-i-type-unicode-characters-without-using-the-mouse"
        moz-do-not-send="true">then type in u + unicode and hit Enter to
        get it</a>. And in Emacs you can insert an unicode char with the
      sequence: <code>‘C-x 8 RET’</code> followed with unicode of the
      character you want.</p>
    <ul>
      <li>&lt;- : ← , unicode 2190 (this doesn't looks like but it is an
        hexadecimal number !) This operator assignment was used in <a
          href="https://en.wikipedia.org/wiki/APL_%28programming_language%29"
          target="_blank">APL</a></li>
      <li>-&gt; : → ,unicode 2192</li>
      <li>&lt;+ : ⥆ , unicode 2946 (Add a variable in the current
        environment)</li>
      <li>+&gt; : ⥅ , unicode 2945</li>
      <li>&lt;&gt; : ≠ , unicode 2260</li>
    </ul>
    <p>Example:</p>
    <pre>scheme@(guile-user)&gt; {v ⥆ 7}
scheme@(guile-user)&gt; v
7</pre>
    <div style="text-align: center;"><br>
    </div>
    <div style="text-align: left;"><br>
    </div>
    <div style="text-align: left;">
      <h2><u>20. Scheme+ in action:</u></h2>
      <p>Example based on the <a
          href="https://en.wikipedia.org/wiki/Petrick%27s_method"
          target="_blank">Petrick method</a> algorithm:</p>
      <p><br>
      </p>
      <!-- HTML generated using hilite.me -->
      <div style="background: #111111;
        overflow:auto;width:auto;border:solid gray;border-width:.1em
        .1em .1em .8em;padding:.2em .6em;">
        <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">def</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">Petrick</span> <span style="color: #fb660a">non-essential-prime-implicants</span> <span style="color: #fb660a">var-list</span><span style="color: #ffffff">)</span>

  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; create the conjunction of disjunction expression</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">mt</span> <span style="color: #fb660a">conj-expr</span> <span style="color: #fb660a">prim-imp</span> <span style="color: #fb660a">col</span> <span style="color: #fb660a">disj-expr</span> <span style="color: #fb660a">disj-expr-sorted</span> <span style="color: #fb660a">mt-var</span> <span style="color: #fb660a">missing-term</span><span style="color: #ffffff">)</span>

  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">display-nl</span> <span style="color: #0086d2">"Entering Petrick..."</span><span style="color: #ffffff">)</span>
  
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">x</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">lgt-mt</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; loop over minterms</span>
       
       <span style="color: #ffffff">{</span><span style="color: #fb660a">mt</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">]}</span>
       
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(member </span><span style="color: #fb660a">mt</span> <span style="color: #fb660a">non-expressed-minterms</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; non expressed minterm</span>
	 
	 <span style="color: #ffffff">{</span><span style="color: #fb660a">col</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">'()}</span>
	 
	 <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">y</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">lgt-pi</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; loop over prime implicants</span>
	      
	      <span style="color: #ffffff">{</span><span style="color: #fb660a">prim-imp</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">]}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; prime implicant</span>
	      
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; check wether prime implicant is a non essential one?</span>
	      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(member </span><span style="color: #fb660a">prim-imp</span> <span style="color: #fb660a">non-essential-prime-implicants</span><span style="color: #ffffff">)</span>
		
		<span style="color: #008800; font-style: italic; background-color: #0f140f">;; is the non essential prime implicant expressing this minterms?</span>
		<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(string=? {</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">]}</span> <span style="color: #0086d2">" * "</span><span style="color: #ffffff">)</span>
		  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">insert-set!</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">minterm-&gt;var</span> <span style="color: #fb660a">prim-imp</span><span style="color: #ffffff">)</span> <span style="color: #fb660a">col</span><span style="color: #ffffff">))))</span>
	 
	 <span style="color: #008800; font-style: italic; background-color: #0f140f">;; end for y</span>
	 
	 <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">singleton-set?</span> <span style="color: #fb660a">col</span><span style="color: #ffffff">)</span>
	     <span style="color: #ffffff">{</span><span style="color: #fb660a">col</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(car </span><span style="color: #fb660a">col</span><span style="color: #ffffff">)}</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; ( V ) -&gt; V</span>
	     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">insert-set!</span> <span style="color: #0086d2">'or</span> <span style="color: #fb660a">col</span><span style="color: #ffffff">))</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (V1 V2 ...) -&gt; (or V1 V2 ...)</span>
	 
	 <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">insert-set!</span> <span style="color: #fb660a">col</span> <span style="color: #fb660a">conj-expr</span><span style="color: #ffffff">)))</span>
  
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; end for x</span>

  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">singleton-set?</span> <span style="color: #fb660a">conj-expr</span><span style="color: #ffffff">)</span>
      <span style="color: #ffffff">{</span><span style="color: #fb660a">conj-expr</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(car </span><span style="color: #fb660a">conj-expr</span><span style="color: #ffffff">)}</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; ( conj-expr ) -&gt; conj-expr</span>
      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">insert-set!</span> <span style="color: #0086d2">'and</span> <span style="color: #fb660a">conj-expr</span><span style="color: #ffffff">))</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (e1 e2 ...) -&gt; (and e1 e2 ...)</span>


  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; find the disjunctive form</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">disj-expr</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dnf-n-arity-simp</span> <span style="color: #fb660a">conj-expr</span><span style="color: #ffffff">)}</span>
  
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; sorting terms</span>
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; sort by x &lt; 1 &lt; 0</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">disj-expr-sorted</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">sort-arguments-in-operation-most-little-literal-first</span> <span style="color: #fb660a">disj-expr</span><span style="color: #ffffff">)}</span>
 
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; get the shortest minterm</span>
  <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">isOR-AND?</span> <span style="color: #fb660a">disj-expr-sorted</span><span style="color: #ffffff">)</span>
      <span style="color: #ffffff">{</span><span style="color: #fb660a">mt-var</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">first</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">args</span> <span style="color: #fb660a">disj-expr-sorted</span><span style="color: #ffffff">))}</span>
      <span style="color: #ffffff">{</span><span style="color: #fb660a">mt-var</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">disj-expr-sorted</span><span style="color: #ffffff">})</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">mt</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">var-&gt;minterm</span> <span style="color: #fb660a">mt-var</span><span style="color: #ffffff">)}</span>

  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; TODO: possible bug missing term could be an expression ? (multiple terms)</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">missing-term</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">essential-prime-implicants-list-&gt;formula</span> <span style="color: #ffffff">(list </span><span style="color: #fb660a">mt</span><span style="color: #ffffff">)</span>
							    <span style="color: #fb660a">var-list</span><span style="color: #ffffff">)}</span>

  <span style="color: #fb660a">missing-term</span>
      
<span style="color: #ffffff">)</span>
</pre>
      </div>
    </div>
    <p> </p>
    <p><br>
    </p>
    <p><br>
    </p>
    <p>Example based on the <a
        href="https://en.wikipedia.org/wiki/Quine%E2%80%93McCluskey_algorithm"
        target="_blank">Quine–McCluskey</a> algorithm:</p>
    <p><br>
    </p>
    <p><!-- HTML generated using hilite.me --></p>
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">def</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">Quine-Mc-Cluskey</span> <span style="color: #fb660a">disj-norm-form</span> <span style="color: #fb660a">var-list</span><span style="color: #ffffff">)</span>
     
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">display-nl</span> <span style="color: #0086d2">"Entering Quine-Mc-Cluskey"</span><span style="color: #ffffff">)</span>
     
     <span style="color: #ffffff">{</span><span style="color: #fb660a">and-terms</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">args</span> <span style="color: #fb660a">disj-norm-form</span><span style="color: #ffffff">)}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; conjunctives minterms</span>
     <span style="color: #008800; font-style: italic; background-color: #0f140f">;; variable list of expanded minterms </span>
     <span style="color: #ffffff">{</span><span style="color: #fb660a">expanded-var-terms</span>  <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">$</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">debug-mode-save</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">debug-mode</span><span style="color: #ffffff">}</span>
			        <span style="color: #ffffff">{</span><span style="color: #fb660a">debug-mode</span>  <span style="color: #ffffff">←</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">}</span>
				<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #fb660a">debug-mode</span>
				  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">and-terms</span><span style="color: #ffffff">))</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dv:display value</span>
				<span style="color: #ffffff">{</span><span style="color: #fb660a">debug-mode</span>  <span style="color: #ffffff">←</span> <span style="color: #fb660a">debug-mode-save</span><span style="color: #ffffff">}</span>
				<span style="color: #ffffff">(apply </span><span style="color: #fb660a">append</span>
				       <span style="color: #ffffff">(map (</span><span style="color: #fb660a; font-weight: bold">λ </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">min-term</span><span style="color: #ffffff">)</span>
					      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">expand-minterm</span> <span style="color: #fb660a">var-list</span> <span style="color: #fb660a">min-term</span><span style="color: #ffffff">))</span>
					    <span style="color: #fb660a">and-terms</span><span style="color: #ffffff">)))}</span>

     <span style="color: #ffffff">{</span><span style="color: #fb660a">sorted-expanded-var-terms</span>  <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(map </span><span style="color: #fb660a">sort-arguments</span> <span style="color: #fb660a">expanded-var-terms</span><span style="color: #ffffff">)}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; sorted variable list of expanded minterms</span>
     <span style="color: #ffffff">{</span><span style="color: #fb660a">binary-minterms</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(map </span><span style="color: #fb660a">var-&gt;binary</span> <span style="color: #fb660a">sorted-expanded-var-terms</span><span style="color: #ffffff">)}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; minterms in binary form</span>
     <span style="color: #ffffff">{</span><span style="color: #fb660a">sorted-binary-minterms</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">sort</span> <span style="color: #fb660a">binary-minterms</span> <span style="color: #fb660a">minterm-binary-weight-number&lt;?</span><span style="color: #ffffff">)}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; sorted binary minterms</span>
     <span style="color: #ffffff">{</span><span style="color: #fb660a">uniq-sorted-binary-minterms</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">remove-duplicates-sorted</span> <span style="color: #fb660a">sorted-binary-minterms</span><span style="color: #ffffff">)}</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; prevoir uniq pourquoi???? sais plus !</span>
     <span style="color: #ffffff">{</span><span style="color: #fb660a">minterms</span> <span style="color: #ffffff">⥆</span> <span style="color: #fb660a">uniq-sorted-binary-minterms</span><span style="color: #ffffff">}</span>
     <span style="color: #ffffff">{</span><span style="color: #fb660a">set-of-sets-of-minterms</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">order-by-weight-minterms</span> <span style="color: #fb660a">uniq-sorted-binary-minterms</span><span style="color: #ffffff">)}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; set of sets of minterms ordered by weight</span>
     <span style="color: #ffffff">{</span><span style="color: #fb660a">unified-minterms</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">$</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">debug-mode-save</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">debug-mode</span><span style="color: #ffffff">}</span>
			     <span style="color: #ffffff">{</span><span style="color: #fb660a">debug-mode</span> <span style="color: #ffffff">←</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">}</span>
			     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #fb660a">debug-mode</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">display-nl</span> <span style="color: #0086d2">"Quine-Mc-Cluskey:"</span><span style="color: #ffffff">))</span>
			     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">init-hash-table-with-set-and-value</span> <span style="color: #fb660a">minterms-ht</span> <span style="color: #fb660a">minterms</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">)</span>
			     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">minterms-ht</span><span style="color: #ffffff">)</span>
			     <span style="color: #ffffff">{</span><span style="color: #fb660a">debug-mode</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">debug-mode-save</span><span style="color: #ffffff">}</span>
			     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">recursive-unify-minterms-set-of-sets</span>  <span style="color: #fb660a">set-of-sets-of-minterms</span><span style="color: #ffffff">))}</span>
	 
     <span style="color: #ffffff">{</span><span style="color: #fb660a">essential-prime-implicants</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">$</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">prime-implicants-lst</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">$</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">debug-mode</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">debug-mode-save</span><span style="color: #ffffff">}</span>
								  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">prime-implicants</span> <span style="color: #fb660a">minterms-ht</span><span style="color: #ffffff">))}</span>
				       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">identify-essential-prime-implicants</span> <span style="color: #fb660a">prime-implicants-lst</span> <span style="color: #fb660a">minterms</span><span style="color: #ffffff">))}</span>
       
     <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dv : display value</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">disj-norm-form</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">var-list</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">and-terms</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">expanded-var-terms</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">sorted-expanded-var-terms</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">binary-minterms</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">sorted-binary-minterms</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">uniq-sorted-binary-minterms</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dvsos</span> <span style="color: #fb660a">set-of-sets-of-minterms</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">unified-minterms</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">minterms-ht</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">prime-implicants-lst</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">essential-prime-implicants</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">display-nl</span> <span style="color: #0086d2">"function expressed by essential prime implicants ?"</span><span style="color: #ffffff">)</span>
     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">dv</span> <span style="color: #fb660a">feepi</span><span style="color: #ffffff">)</span>
     <span style="color: #fb660a">essential-prime-implicants</span><span style="color: #ffffff">)</span>
</pre>
    </div>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #008800; font-style: italic; background-color: #0f140f">;; e element</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; s set</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; sos set of sets</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">put-elements-of-set-of-sets-in-minterms-ht</span> <span style="color: #fb660a">sos</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(map </span><span style="color: #008800; font-style: italic; background-color: #0f140f">;; deal with sets of the 'set of sets'</span>
   <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">λ </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">s</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(map </span><span style="color: #008800; font-style: italic; background-color: #0f140f">;; deal with elements of a set</span>
		<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">λ </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">e</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">minterms-ht</span><span style="color: #ffffff">[</span><span style="color: #fb660a">e</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">})</span>
		<span style="color: #fb660a">s</span><span style="color: #ffffff">))</span>
   <span style="color: #fb660a">sos</span><span style="color: #ffffff">))</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;; unify function for two minterms</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; (function-unify-two-minterms-and-tag '(1 0 0 0) '(1 0 1 0)) -&gt; '(1 0 x 0)</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">function-unify-two-minterms-and-tag</span> <span style="color: #fb660a">mt1</span> <span style="color: #fb660a">mt2</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">res</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">unify-two-minterms</span> <span style="color: #fb660a">mt1</span> <span style="color: #fb660a">mt2</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #fb660a">res</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">minterms-ht</span><span style="color: #ffffff">[</span><span style="color: #fb660a">mt1</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">}</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">minterms-ht</span><span style="color: #ffffff">[</span><span style="color: #fb660a">mt2</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">})</span>
  <span style="color: #fb660a">res</span><span style="color: #ffffff">)</span>



<span style="color: #008800; font-style: italic; background-color: #0f140f">;; (init-hash-table-with-set-and-value ht '((1 0 0 0) (0 1 0 1) (1 0 1 0) (1 1 0 0) (0 1 1 1) (1 1 0 1) (1 1 1 0) (1 1 1 1)) #f)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; '(#&lt;void&gt; #&lt;void&gt; #&lt;void&gt; #&lt;void&gt; #&lt;void&gt; #&lt;void&gt; #&lt;void&gt; #&lt;void&gt;)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; &gt; ht</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; '#hash(((1 1 0 1) . #f)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;        ((1 1 0 0) . #f)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;        ((0 1 0 1) . #f)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;        ((0 1 1 1) . #f)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;        ((1 0 0 0) . #f)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;        ((1 1 1 1) . #f)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;        ((1 1 1 0) . #f)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;        ((1 0 1 0) . #f))</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;; used by Quine - Mc Cluskey</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">init-hash-table-with-set-and-value</span> <span style="color: #fb660a">ht</span> <span style="color: #fb660a">s</span> <span style="color: #fb660a">val</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(display </span><span style="color: #0086d2">"init-hash-table-with-set-and-value"</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">newline</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">ht</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">make-hash-table</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">(map (</span><span style="color: #fb660a; font-weight: bold">λ </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">e</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">ht</span><span style="color: #ffffff">[</span><span style="color: #fb660a">e</span><span style="color: #ffffff">]</span> <span style="color: #fb660a">&lt;-</span> <span style="color: #fb660a">val</span><span style="color: #ffffff">})</span> <span style="color: #fb660a">s</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(display </span><span style="color: #0086d2">"end of init-hash-table-with-set-and-value"</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">newline</span><span style="color: #ffffff">))</span>


<span style="color: #008800; font-style: italic; background-color: #0f140f">;; list of non expressed minterms</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">non-expressed-minterms</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">'()}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; could also be done with (declare non-expressed-minterms)</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;; iepi : identifying essential prime implicant array</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; first line : minterms</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; first row : prime-implicants</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; for now i do not know the array dimension</span>
<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">declare</span> <span style="color: #fb660a">iepi</span> <span style="color: #fb660a">lgt-pi</span> <span style="color: #fb660a">lgt-mt</span><span style="color: #ffffff">)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; example part of output:</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;; {iepi[1 2]} = 0</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; {iepi[1 2] ← 1} = 1</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #(() (0 0 0 0) (0 0 0 1) (0 0 1 0) (1 0 0 0) (0 1 0 1) (0 1 1 0) (1 0 0 1) (1 0 1 0) (0 1 1 1) (1 1 1 0))</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #(0 0 0 0 0 0 0 0 0 0 0)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #(0 1 0 0 0 0 0 0 0 0 0)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #(0 0 0 0 0 0 0 0 0 0 0)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #(0 0 0 0 0 0 0 0 0 0 0)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #(0 0 0 0 0 0 0 0 0 0 0)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #(0 0 0 0 0 0 0 0 0 0 0)</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;; iepi = </span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #(() (0 0 0 0) (0 0 0 1) (0 0 1 0) (1 0 0 0) (0 1 0 1) (0 1 1 0) (1 0 0 1) (1 0 1 0) (0 1 1 1) (1 1 1 0))</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #((0 x 0 1)      *           *                     )</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #((0 1 x 1)                  *               *     )</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #((0 1 1 x)                      *           *     )</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #((x x 1 0)          *           *       *      (*))</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #((x 0 0 x)  *   *       *          (*)            )</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; #((x 0 x 0)  *       *   *               *         )</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">identify-essential-prime-implicants</span>  <span style="color: #fb660a">prime-implicants</span> <span style="color: #fb660a">minterms</span><span style="color: #ffffff">)</span>
    <span style="color: #ffffff">{</span><span style="color: #fb660a">vct-prime-implicants</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(list-&gt;vector </span><span style="color: #fb660a">prime-implicants</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">essential-prime-implicants-list</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">'()}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">cpt-mt</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; counter of minterms</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">y-pos-epi</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; position of essential prime implicant in colomn if there exists one</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">star-in-column</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; at the beginning</span>
  
  <span style="color: #ffffff">{</span><span style="color: #fb660a">lgt-pi</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">prime-implicants</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">lgt-mt</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(length </span><span style="color: #fb660a">minterms</span><span style="color: #ffffff">)}</span>
  
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; identifying essential prime implicant array</span>
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; first line : minterms</span>
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; first row : prime-implicants</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">make-array-2d</span> <span style="color: #ffffff">(+ </span><span style="color: #fb660a">lgt-mt</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(+ </span><span style="color: #fb660a">lgt-pi</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">)</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">)}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; two dimensions array</span>
 
  <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(list-&gt;vector (cons '()</span> <span style="color: #fb660a">minterms</span><span style="color: #ffffff">))}</span>
 
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; set the title line</span>

  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; construction of the array</span>
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; set the left column containing prime implicants </span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">y</span> <span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #ffffff">(- </span><span style="color: #fb660a">lgt-pi</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">))</span>
         <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #ffffff">(+ </span><span style="color: #fb660a">y</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">)]</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">vct-prime-implicants</span><span style="color: #ffffff">[</span><span style="color: #fb660a">y</span><span style="color: #ffffff">]}})</span>
 
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; identify prime implicants</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">x</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">lgt-mt</span><span style="color: #ffffff">)</span>
       
       <span style="color: #ffffff">{</span><span style="color: #fb660a">cpt-mt</span> <span style="color: #ffffff">←</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span>
       
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">y</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">lgt-pi</span><span style="color: #ffffff">)</span>

	    <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">compare-minterm-and-implicant</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">]}</span>
					       <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">]})</span>
		<span style="color: #008800; font-style: italic; background-color: #0f140f">;; then</span>
		<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">$</span>
		  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">incf</span> <span style="color: #fb660a">cpt-mt</span><span style="color: #ffffff">)</span>
		  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(= </span><span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">cpt-mt</span><span style="color: #ffffff">)</span>
			<span style="color: #ffffff">{</span><span style="color: #fb660a">y-pos-epi</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">})</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; position of essential prime implicant</span>
		  <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">←</span> <span style="color: #0086d2">" * "</span><span style="color: #ffffff">})</span>
		
		<span style="color: #008800; font-style: italic; background-color: #0f140f">;; else</span>
		<span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">←</span> <span style="color: #0086d2">"   "</span><span style="color: #ffffff">}))</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; end for y</span>
       
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(= </span><span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">cpt-mt</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; essential prime implicant</span>
	     <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">y-pos-epi</span><span style="color: #ffffff">]</span> <span style="color: #ffffff">←</span> <span style="color: #0086d2">"(*)"</span><span style="color: #ffffff">}</span>
	     <span style="color: #008800; font-style: italic; background-color: #0f140f">;; add essential prime implicant to list</span>
	     <span style="color: #ffffff">{</span><span style="color: #fb660a">essential-prime-implicants-list</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(cons {</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #fb660a">y-pos-epi</span><span style="color: #ffffff">]}</span> <span style="color: #fb660a">essential-prime-implicants-list</span><span style="color: #ffffff">)})</span>

     <span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; end for x</span>
  
  <span style="color: #ffffff">{</span><span style="color: #fb660a">essential-prime-implicants-list</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">remove-duplicates</span> <span style="color: #fb660a">essential-prime-implicants-list</span><span style="color: #ffffff">)}</span>

  <span style="color: #ffffff">{</span><span style="color: #fb660a">feepi</span> <span style="color: #ffffff">←</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">}</span>
  
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; check if function is expressed by essential implicants</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for/break</span> <span style="color: #fb660a">break-x</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">x</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">lgt-mt</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; loop over minterms</span>
	     
	     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for/break</span> <span style="color: #fb660a">break-y</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">y</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">lgt-pi</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; loop over prime implicants</span>

			<span style="color: #008800; font-style: italic; background-color: #0f140f">;; check wether prime implicant is an essential one?</span>
			<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(member {</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">]}</span> <span style="color: #fb660a">essential-prime-implicants-list</span><span style="color: #ffffff">)</span>
			  			      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; is the essential prime implicant expressing this minterms?</span>
			      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">or </span><span style="color: #ffffff">(string=? </span> <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">]}</span> <span style="color: #0086d2">"(*)"</span><span style="color: #ffffff">)</span>
					<span style="color: #ffffff">(string=? </span> <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">]}</span> <span style="color: #0086d2">" * "</span><span style="color: #ffffff">))</span>
				    
	
				    <span style="color: #ffffff">{</span><span style="color: #fb660a">star-in-column</span> <span style="color: #ffffff">←</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">}</span>
				    
				    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">break-y</span><span style="color: #ffffff">))))</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; that's enought! we know the minterm is expressed.</span>

	     <span style="color: #008800; font-style: italic; background-color: #0f140f">;; end for/break break-y</span>
	     
	     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">unless</span> <span style="color: #fb660a">star-in-column</span>
		     <span style="color: #ffffff">{</span><span style="color: #fb660a">feepi</span> <span style="color: #ffffff">←</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; function non expressed by prime implicants</span>
		     <span style="color: #008800; font-style: italic; background-color: #0f140f">;; add minterm to non expressed minterms list</span>
		     <span style="color: #ffffff">{</span><span style="color: #fb660a">non-expressed-minterms</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">insert</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">iepi</span><span style="color: #ffffff">[</span><span style="color: #fb660a">x</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">]}</span> <span style="color: #fb660a">non-expressed-minterms</span><span style="color: #ffffff">)}</span>
		     <span style="color: #008800; font-style: italic; background-color: #0f140f">;;(break-x) ;; removed break-x as we have to check all the minterms now</span>
		     <span style="color: #ffffff">)</span>
	     
	     <span style="color: #ffffff">{</span><span style="color: #fb660a">star-in-column</span> <span style="color: #ffffff">←</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">})</span>  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; set it for the next loop</span>
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; end for/break break-x</span>

  <span style="color: #fb660a">essential-prime-implicants-list</span><span style="color: #ffffff">)</span>
</pre>
    </div>
    <br>
    <br>
    <br>
    <br>
    <h2><u>21. Contributors:</u></h2>
    Maxime Devos<br>
    Rebecca Turner<br>
    <br>
    <br>
    <br>
    <h2><u>22. DrRacket graphic example in Scheme+:</u></h2>
    <p>This example&nbsp; create a graphic application that draw
      interactively&nbsp; the <a
        href="https://en.wikipedia.org/wiki/Riemann_zeta_function"
        moz-do-not-send="true">ζ complex Riemann function</a> of the
      point value under mouse pointer. It also have a more accurate mode
      but with no interaction (because Riemann zeta function is very
      time consuming to compute) , the value is possible for any complex
      number z with real part greater than 1 (no analytic continuation
      in this version):<br>
    </p>
    <p align="center"><br>
    </p>
    <div align="center"><img src="Scheme+io_fichiers/zeta-DrRacket.png"
        moz-do-not-send="true" alt="zeta riemann" width="700" border="3"
        height="438"><br>
    </div>
    <br>
    <br>
    <br>
    And here is the code (available in the example directory of the
    Scheme+ package):<br>
    <br>
    <br>
    <!-- HTML generated using hilite.me -->
    <div style="background: #111111;
      overflow:auto;width:auto;border:solid gray;border-width:.1em .1em
      .1em .8em;padding:.2em .6em;">
      <pre style="margin: 0; line-height: 125%"><span style="color: #ffffff">#</span><span style="color: #fb660a">lang</span> <span style="color: #fb660a">reader</span> <span style="color: #0086d2">"../SRFI/SRFI-105.rkt"</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;;(require Scheme-PLUS-for-Racket/Scheme+)</span>

<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">require</span> <span style="color: #0086d2">"../Scheme+.rkt"</span><span style="color: #ffffff">)</span>

<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">include</span> <span style="color: #0086d2">"../library/increment.scm"</span><span style="color: #ffffff">)</span>
<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">include</span> <span style="color: #0086d2">"../library/for-next-step.scm"</span><span style="color: #ffffff">)</span>
<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">include</span> <span style="color: #0086d2">"../library/repeat-until.scm"</span><span style="color: #ffffff">)</span>

<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">require</span> <span style="color: #fb660a">racket/gui/base</span><span style="color: #ffffff">)</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">animation-mode</span> <span style="color: #0086d2">#f</span><span style="color: #ffffff">)</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">xws</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">1000</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; X window size</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">yws</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">800</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; Y window size</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">ywsp</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">yws</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">200</span><span style="color: #ffffff">}}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; Y window size for plot</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">; Make a frame by instantiating the frame% class</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">frame0</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">new</span> <span style="color: #fb660a">frame%</span> <span style="color: #ffffff">[</span><span style="color: #fb660a">label</span> <span style="color: #0086d2">"Example"</span><span style="color: #ffffff">]</span>
	       <span style="color: #ffffff">[</span><span style="color: #fb660a">width</span> <span style="color: #fb660a">xws</span><span style="color: #ffffff">]</span>
	       <span style="color: #ffffff">[</span><span style="color: #fb660a">height</span> <span style="color: #fb660a">yws</span><span style="color: #ffffff">])}</span>


<span style="color: #008800; font-style: italic; background-color: #0f140f">; Make a static text message in the frame</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">msg</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">new</span> <span style="color: #fb660a">message%</span> <span style="color: #ffffff">[</span><span style="color: #fb660a">parent</span> <span style="color: #fb660a">frame0</span><span style="color: #ffffff">]</span>
	    <span style="color: #ffffff">[</span><span style="color: #fb660a">label</span> <span style="color: #0086d2">"No events so far..."</span><span style="color: #ffffff">])}</span>
 
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; Make a button in the frame</span>
<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">new</span> <span style="color: #fb660a">button%</span> <span style="color: #ffffff">[</span><span style="color: #fb660a">parent</span> <span style="color: #fb660a">frame0</span><span style="color: #ffffff">]</span>
             <span style="color: #ffffff">[</span><span style="color: #fb660a">label</span> <span style="color: #0086d2">"Exit"</span><span style="color: #ffffff">]</span>
             <span style="color: #008800; font-style: italic; background-color: #0f140f">; Callback procedure for a button click:</span>
             <span style="color: #ffffff">[</span><span style="color: #fb660a">callback</span> <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">lambda </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">button</span> <span style="color: #fb660a">event</span><span style="color: #ffffff">)</span>
                         <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">msg</span> <span style="color: #fb660a">set-label</span> <span style="color: #0086d2">"Button click"</span><span style="color: #ffffff">)</span>
			 <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">exit</span><span style="color: #ffffff">))])</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">no-pen</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">new</span> <span style="color: #fb660a">pen%</span> <span style="color: #ffffff">[</span><span style="color: #fb660a">style</span> <span style="color: #0086d2">'transparent</span><span style="color: #ffffff">]))</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">no-brush</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">new</span> <span style="color: #fb660a">brush%</span> <span style="color: #ffffff">[</span><span style="color: #fb660a">style</span> <span style="color: #0086d2">'transparent</span><span style="color: #ffffff">]))</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">blue-brush</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">new</span> <span style="color: #fb660a">brush%</span> <span style="color: #ffffff">[</span><span style="color: #fb660a">color</span> <span style="color: #0086d2">"blue"</span><span style="color: #ffffff">]))</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #fb660a">yellow-brush</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">new</span> <span style="color: #fb660a">brush%</span> <span style="color: #ffffff">[</span><span style="color: #fb660a">color</span> <span style="color: #0086d2">"yellow"</span><span style="color: #ffffff">]))</span>


<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-z-point</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">set-pen</span> <span style="color: #fb660a">no-pen</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">set-brush</span> <span style="color: #fb660a">blue-brush</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">ga</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">8</span><span style="color: #ffffff">}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">pa</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">8</span><span style="color: #ffffff">}</span>
  <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">x</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">to-screen-multi-values</span> <span style="color: #fb660a">z</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">x</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">-</span> <span style="color: #ffffff">(quotient </span><span style="color: #fb660a">ga</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">)}}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">y</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">y</span> <span style="color: #fb660a">-</span> <span style="color: #ffffff">(quotient </span><span style="color: #fb660a">pa</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">)}}</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-ellipse</span> <span style="color: #fb660a">x</span> <span style="color: #fb660a">y</span> <span style="color: #fb660a">ga</span> <span style="color: #fb660a">pa</span><span style="color: #ffffff">))</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;; convert to screen coords</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">to-screen</span> <span style="color: #fb660a">z0</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">re</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(real-part </span><span style="color: #fb660a">z0</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">im</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(imag-part </span><span style="color: #fb660a">z0</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">xs</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">re</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">ys</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">im</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}</span>
  <span style="color: #ffffff">(make-rectangular (round {</span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">+</span> <span style="color: #fb660a">xs</span><span style="color: #ffffff">})</span>
		    <span style="color: #ffffff">(round {</span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">ys</span><span style="color: #ffffff">})))</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">to-screen-multi-values</span> <span style="color: #fb660a">z0</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">re</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(real-part </span><span style="color: #fb660a">z0</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">im</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(imag-part </span><span style="color: #fb660a">z0</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">xs</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">re</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">ys</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">im</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}</span>
  <span style="color: #ffffff">(values (round {</span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">+</span> <span style="color: #fb660a">xs</span><span style="color: #ffffff">})</span>
	  <span style="color: #ffffff">(round {</span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">ys</span><span style="color: #ffffff">})))</span>



<span style="color: #008800; font-style: italic; background-color: #0f140f">;;{z ⥆ 0}</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;{z ⥆ 2+1i}</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">z</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">1.13</span><span style="color: #fb660a">+1</span><span style="color: #ffffff">.</span><span style="color: #0086f7; font-weight: bold">765</span><span style="color: #fb660a">i</span><span style="color: #ffffff">}</span>


<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-zeta</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>
  
  <span style="color: #ffffff">{</span><span style="color: #fb660a">zi</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">nmax</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">10000000</span><span style="color: #ffffff">}</span>
  
  <span style="color: #ffffff">{</span><span style="color: #fb660a">flag-color</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">}</span>
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;;(newline)</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">n</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">nmax</span><span style="color: #ffffff">)</span>
       <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #fb660a">flag-color</span>
	   <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">set-pen</span> <span style="color: #0086d2">"blue"</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086d2">'solid</span><span style="color: #ffffff">)</span>
	   <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">set-pen</span> <span style="color: #0086d2">"green"</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086d2">'solid</span><span style="color: #ffffff">))</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">flag-color</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(not </span><span style="color: #fb660a">flag-color</span><span style="color: #ffffff">)}</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;;(display "draw-zeta : n =") (display n) (newline)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">zp</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #0086f7; font-weight: bold">1.0</span> <span style="color: #fb660a">/</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">**</span> <span style="color: #fb660a">z</span><span style="color: #ffffff">}}}</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (display "draw-zeta : z =") (display z) (newline)</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (display "draw-zeta : zp =") (display zp) (newline)</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (display "draw-zeta : zi =") (display zi) (newline)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">zxtrm</span>  <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">zi</span> <span style="color: #fb660a">+</span> <span style="color: #fb660a">zp</span><span style="color: #ffffff">}}</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;;(display "draw-zeta : zxtrm =") (display zxtrm) (newline)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">zie</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">to-screen</span> <span style="color: #fb660a">zi</span><span style="color: #ffffff">)}</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;;(display "draw-zeta : zie =") (display zie) (newline)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">zxtrme</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">to-screen</span> <span style="color: #fb660a">zxtrm</span><span style="color: #ffffff">)}</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;;(display "draw-zeta : zxtrme =") (display zxtrme) (newline)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">x0</span> <span style="color: #ffffff">⥆</span>  <span style="color: #ffffff">(real-part </span><span style="color: #fb660a">zie</span><span style="color: #ffffff">)}</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">y0</span> <span style="color: #ffffff">⥆</span>  <span style="color: #ffffff">(imag-part </span><span style="color: #fb660a">zie</span><span style="color: #ffffff">)}</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">x1</span> <span style="color: #ffffff">⥆</span>  <span style="color: #ffffff">(real-part </span><span style="color: #fb660a">zxtrme</span><span style="color: #ffffff">)}</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">y1</span> <span style="color: #ffffff">⥆</span>  <span style="color: #ffffff">(imag-part </span><span style="color: #fb660a">zxtrme</span><span style="color: #ffffff">)}</span>
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">{{</span><span style="color: #fb660a">x0</span> <span style="color: #fb660a">&gt;=</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">x0</span> <span style="color: #fb660a">&lt;=</span> <span style="color: #fb660a">xws</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span> <span style="color: #ffffff">{</span><span style="color: #fb660a">x1</span> <span style="color: #fb660a">&gt;=</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">x1</span> <span style="color: #fb660a">&lt;=</span> <span style="color: #fb660a">xws</span><span style="color: #ffffff">}</span>
	      <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">y0</span> <span style="color: #fb660a">&gt;=</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">y0</span> <span style="color: #fb660a">&lt;=</span> <span style="color: #fb660a">ywsp</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span> <span style="color: #ffffff">{</span><span style="color: #fb660a">y1</span> <span style="color: #fb660a">&gt;=</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">y1</span> <span style="color: #fb660a">&lt;=</span> <span style="color: #fb660a">ywsp</span><span style="color: #ffffff">}}</span>
	     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-line</span>
		   <span style="color: #fb660a">x0</span> <span style="color: #fb660a">y0</span>
		   <span style="color: #fb660a">x1</span> <span style="color: #fb660a">y1</span><span style="color: #ffffff">))</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">zi</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">zxtrm</span><span style="color: #ffffff">}))</span>


<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-zeta-multi-values</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>
  
  <span style="color: #ffffff">{</span><span style="color: #fb660a">zi</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">flag-color</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">dmin</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; minimal length  in pixel to draw line</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">newline</span><span style="color: #ffffff">)</span>
  
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">repeat</span>
   
       <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #fb660a">flag-color</span>
	   <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">set-pen</span> <span style="color: #0086d2">"blue"</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086d2">'solid</span><span style="color: #ffffff">)</span>
	   <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">set-pen</span> <span style="color: #0086d2">"green"</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086d2">'solid</span><span style="color: #ffffff">))</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">flag-color</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(not </span><span style="color: #fb660a">flag-color</span><span style="color: #ffffff">)}</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;;(display "draw-zeta-multi-values : n =") (display n) (newline)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">zp</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #0086f7; font-weight: bold">1.0</span> <span style="color: #fb660a">/</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">**</span> <span style="color: #fb660a">z</span><span style="color: #ffffff">}}}</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">zxtrm</span>  <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">zi</span> <span style="color: #fb660a">+</span> <span style="color: #fb660a">zp</span><span style="color: #ffffff">}}</span>
       <span style="color: #008800; font-style: italic; background-color: #0f140f">;;(display "draw-zeta-multi-values : zxtrm =") (display zxtrm) (newline)</span>
 
       <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">x0</span> <span style="color: #fb660a">y0</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">to-screen-multi-values</span> <span style="color: #fb660a">zi</span><span style="color: #ffffff">)}</span> 
       <span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">x1</span> <span style="color: #fb660a">y1</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">to-screen-multi-values</span> <span style="color: #fb660a">zxtrm</span><span style="color: #ffffff">)}</span>
 
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">{{</span><span style="color: #fb660a">x0</span> <span style="color: #fb660a">&gt;=</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">x0</span> <span style="color: #fb660a">&lt;=</span> <span style="color: #fb660a">xws</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span> <span style="color: #ffffff">{</span><span style="color: #fb660a">x1</span> <span style="color: #fb660a">&gt;=</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">x1</span> <span style="color: #fb660a">&lt;=</span> <span style="color: #fb660a">xws</span><span style="color: #ffffff">}</span>
	      <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">y0</span> <span style="color: #fb660a">&gt;=</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">y0</span> <span style="color: #fb660a">&lt;=</span> <span style="color: #fb660a">ywsp</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span> <span style="color: #ffffff">{</span><span style="color: #fb660a">y1</span> <span style="color: #fb660a">&gt;=</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a; font-weight: bold">and </span><span style="color: #ffffff">{</span><span style="color: #fb660a">y1</span> <span style="color: #fb660a">&lt;=</span> <span style="color: #fb660a">ywsp</span><span style="color: #ffffff">}}</span>
	     <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-line</span>
		   <span style="color: #fb660a">x0</span> <span style="color: #fb660a">y0</span>
		   <span style="color: #fb660a">x1</span> <span style="color: #fb660a">y1</span><span style="color: #ffffff">))</span>

       <span style="color: #ffffff">{</span><span style="color: #fb660a">len-line</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">line-length</span> <span style="color: #fb660a">x0</span> <span style="color: #fb660a">y0</span> <span style="color: #fb660a">x1</span> <span style="color: #fb660a">y1</span><span style="color: #ffffff">)}</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">zi</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">zxtrm</span><span style="color: #ffffff">}</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">1</span><span style="color: #ffffff">}}</span>
       
       <span style="color: #fb660a">until</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">len-line</span> <span style="color: #fb660a">&lt;</span> <span style="color: #fb660a">dmin</span><span style="color: #ffffff">})</span>

  <span style="color: #ffffff">(display </span><span style="color: #0086d2">"draw-zeta-multi-values : z ="</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(display </span><span style="color: #fb660a">z</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">newline</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(display </span><span style="color: #0086d2">"draw-zeta-multi-values : Riemann Zeta(z) = zi ="</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(display </span><span style="color: #fb660a">zi</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">newline</span><span style="color: #ffffff">)</span>

  <span style="color: #ffffff">)</span>



<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">line-length</span> <span style="color: #fb660a">x0</span> <span style="color: #fb660a">y0</span> <span style="color: #fb660a">x1</span> <span style="color: #fb660a">y1</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(sqrt {{{</span><span style="color: #fb660a">x1</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">x0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">**</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">+</span> <span style="color: #ffffff">{{</span><span style="color: #fb660a">y1</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">y0</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">**</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">}}))</span>


<span style="color: #008800; font-style: italic; background-color: #0f140f">;; (new button% [parent frame0]</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;              [label "Pause"]</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;              [callback (λ (button event) (sleep 5))])</span>


<span style="color: #008800; font-style: italic; background-color: #0f140f">;; {panel ⥆ (new horizontal-panel% [parent frame0])}</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;; (new button% [parent panel]</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;              [label "Left"]</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;              [callback (λ (button event)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;                          (send msg set-label "Left click"))])</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;; (new button% [parent panel]</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;              [label "Right"]</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;              [callback (λ (button event)</span>
<span style="color: #008800; font-style: italic; background-color: #0f140f">;;                          (send msg set-label "Right click"))])</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">z-old</span> <span style="color: #ffffff">⥆</span> <span style="color: #fb660a">z</span><span style="color: #ffffff">}</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">; Derive a new canvas (a drawing window) class to handle events</span>
<span style="color: #ffffff">{</span><span style="color: #fb660a">my-canvas%</span> <span style="color: #ffffff">⥆</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">class</span> <span style="color: #fb660a">canvas%</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">; The base class is canvas%</span>
    <span style="color: #008800; font-style: italic; background-color: #0f140f">; Define overriding method to handle mouse events</span>
    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">define/override</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">on-event</span> <span style="color: #fb660a">event</span><span style="color: #ffffff">)</span>
     
      <span style="color: #ffffff">{</span><span style="color: #fb660a">window-x</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">event</span> <span style="color: #fb660a">get-x</span><span style="color: #ffffff">)}</span>
      <span style="color: #ffffff">{</span><span style="color: #fb660a">window-y</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">event</span> <span style="color: #fb660a">get-y</span><span style="color: #ffffff">)}</span>
      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #fb660a">animation-mode</span>
	<span style="color: #ffffff">{</span><span style="color: #fb660a">z</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">ret-z</span> <span style="color: #fb660a">window-x</span> <span style="color: #fb660a">window-y</span><span style="color: #ffffff">)})</span>
      
      <span style="color: #008800; font-style: italic; background-color: #0f140f">;;{str ⥆ (string-append "(" (number-&gt;string window-x) " , " (number-&gt;string window-y) ")")}</span>
      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">when</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">z</span> <span style="color: #ffffff">≠</span> <span style="color: #fb660a">z-old</span><span style="color: #ffffff">}</span>
	    <span style="color: #ffffff">{</span><span style="color: #fb660a">z-old</span> <span style="color: #ffffff">←</span> <span style="color: #fb660a">z</span><span style="color: #ffffff">}</span>
	    <span style="color: #ffffff">{</span><span style="color: #fb660a">str</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(number-&gt;string </span><span style="color: #fb660a">z</span><span style="color: #ffffff">)}</span> 
	    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">msg</span> <span style="color: #fb660a">set-label</span> <span style="color: #fb660a">str</span><span style="color: #ffffff">)</span>
	    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">cv</span> <span style="color: #fb660a">refresh</span><span style="color: #ffffff">))</span>
      
      <span style="color: #ffffff">)</span>
    
    <span style="color: #008800; font-style: italic; background-color: #0f140f">; Define overriding method to handle keyboard events</span>
    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">define/override</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">on-char</span> <span style="color: #fb660a">event</span><span style="color: #ffffff">)</span>
      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">msg</span> <span style="color: #fb660a">set-label</span> <span style="color: #0086d2">"Canvas keyboard"</span><span style="color: #ffffff">))</span>
    <span style="color: #008800; font-style: italic; background-color: #0f140f">; Call the superclass init, passing on all init args</span>
    <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">super-new</span><span style="color: #ffffff">))}</span>


<span style="color: #ffffff">{</span><span style="color: #fb660a">cv</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">new</span> <span style="color: #fb660a">my-canvas%</span> <span style="color: #ffffff">[</span><span style="color: #fb660a">parent</span> <span style="color: #fb660a">frame0</span><span style="color: #ffffff">]</span>
	   <span style="color: #ffffff">[</span><span style="color: #fb660a">paint-callback</span>
	    <span style="color: #ffffff">(λ</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">canvas</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; dc: Drawing Context</span>
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; cf. https://docs.racket-lang.org/draw/overview.html#%28tech._drawing._context%29</span>
	      
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (send dc draw-rectangle</span>
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; 	    (random 10) 10   ; Top-left at (0, 10), 10 pixels down from top-left</span>
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; 	    30 10) ; 30 pixels wide and 10 pixels high</span>
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (send dc draw-line</span>
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; 	    (random 10) 0    ; Start at (0, 0), the top-left corner</span>
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; 	    30 30) ; and draw to (30, 30), the bottom-right corner</span>

	      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">erase</span><span style="color: #ffffff">)</span>
	      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">set-pen</span> <span style="color: #0086d2">"black"</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #0086d2">'solid</span><span style="color: #ffffff">)</span>
	      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-axes</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>
	      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-units</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>
	      <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-z-point</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>

	      <span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">if </span><span style="color: #fb660a">animation-mode</span>
		  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-zeta-multi-values</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>
		  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-zeta</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">))</span>
	      
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (send dc set-scale 3 3)</span>
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (send dc set-text-foreground "blue")</span>
	      <span style="color: #008800; font-style: italic; background-color: #0f140f">;; (send dc draw-text "Don't Panic!" 0 0)</span>
	      <span style="color: #ffffff">)])}</span>




<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">center-coords</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(values (quotient </span><span style="color: #fb660a">xws</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">)</span>
	  <span style="color: #ffffff">(quotient </span><span style="color: #fb660a">ywsp</span> <span style="color: #0086f7; font-weight: bold">2</span><span style="color: #ffffff">)))</span>

<span style="color: #ffffff">{(</span><span style="color: #ff0086; font-weight: bold">xo</span> <span style="color: #fb660a">yo</span><span style="color: #ffffff">)</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">center-coords</span><span style="color: #ffffff">)}</span>

<span style="color: #ffffff">{</span><span style="color: #fb660a">unit</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">200</span><span style="color: #ffffff">}</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-axes</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-line</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; Ox</span>
	<span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #fb660a">yo</span> <span style="color: #fb660a">xws</span> <span style="color: #fb660a">yo</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-line</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; Oy</span>
	<span style="color: #fb660a">xo</span> <span style="color: #0086f7; font-weight: bold">0</span> <span style="color: #fb660a">xo</span> <span style="color: #fb660a">ywsp</span><span style="color: #ffffff">))</span>

<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">draw-units</span> <span style="color: #fb660a">dc</span><span style="color: #ffffff">)</span>
  <span style="color: #008800; font-style: italic; background-color: #0f140f">;;X</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">nun</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(quotient </span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">n</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">nun</span><span style="color: #ffffff">)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">xu</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">+</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}}</span>
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-line</span>
	     <span style="color: #fb660a">xu</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">}</span>
	     <span style="color: #fb660a">xu</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">})</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">xum</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">-</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}}</span>
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-line</span>
	     <span style="color: #fb660a">xum</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">}</span>
	     <span style="color: #fb660a">xum</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">}))</span>

  <span style="color: #008800; font-style: italic; background-color: #0f140f">;; Y</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">nuny</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(quotient </span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">)}</span>
  <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">for</span> <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">n</span> <span style="color: #0086f7; font-weight: bold">1</span> <span style="color: #fb660a">nuny</span><span style="color: #ffffff">)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">yu</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">-</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}}</span>
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-line</span>
	     <span style="color: #ffffff">{</span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">yu</span>
	     <span style="color: #ffffff">{</span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">yu</span><span style="color: #ffffff">)</span>
       <span style="color: #ffffff">{</span><span style="color: #fb660a">yum</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">yo</span> <span style="color: #fb660a">+</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">n</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}}</span>
       <span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">dc</span> <span style="color: #fb660a">draw-line</span>
	     <span style="color: #ffffff">{</span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">-</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">yum</span>
	     <span style="color: #ffffff">{</span><span style="color: #fb660a">xo</span> <span style="color: #fb660a">+</span> <span style="color: #0086f7; font-weight: bold">3</span><span style="color: #ffffff">}</span> <span style="color: #fb660a">yum</span><span style="color: #ffffff">)))</span>

<span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">send</span> <span style="color: #fb660a">frame0</span> <span style="color: #fb660a">show</span> <span style="color: #0086d2">#t</span><span style="color: #ffffff">)</span>

<span style="color: #008800; font-style: italic; background-color: #0f140f">;; return the z complex from canvas plane where is the mouse pointer</span>
<span style="color: #ffffff">(</span><span style="color: #fb660a; font-weight: bold">define </span><span style="color: #ffffff">(</span><span style="color: #ff0086; font-weight: bold">ret-z</span> <span style="color: #fb660a">x</span> <span style="color: #fb660a">y</span><span style="color: #ffffff">)</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">i</span> <span style="color: #ffffff">⥆</span> <span style="color: #0086f7; font-weight: bold">0</span><span style="color: #fb660a">+1i</span><span style="color: #ffffff">}</span> <span style="color: #008800; font-style: italic; background-color: #0f140f">;; imaginaire pur</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">re</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">x</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">xo</span><span style="color: #ffffff">}}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">re</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">re</span> <span style="color: #fb660a">/</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">im</span> <span style="color: #ffffff">⥆</span> <span style="color: #ffffff">(- {</span><span style="color: #fb660a">y</span> <span style="color: #fb660a">-</span> <span style="color: #fb660a">yo</span><span style="color: #ffffff">})}</span>
  <span style="color: #ffffff">{</span><span style="color: #fb660a">im</span> <span style="color: #ffffff">←</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">im</span> <span style="color: #fb660a">/</span> <span style="color: #fb660a">unit</span><span style="color: #ffffff">}}</span>
  <span style="color: #ffffff">(exact-&gt;inexact {</span><span style="color: #fb660a">re</span> <span style="color: #fb660a">+</span> <span style="color: #ffffff">{</span><span style="color: #fb660a">i</span> <span style="color: #fb660a">*</span> <span style="color: #fb660a">im</span><span style="color: #ffffff">}}))</span>
</pre>
    </div>
    <br>
    <br>
    <p align="center"><br>
    </p>
    <div align="center"><img src="Scheme+io_fichiers/zeta-DrRacket.png"
        moz-do-not-send="true" alt="zeta riemann" width="1200"
        border="3" height="750"><br>
    </div>
    <br>
    <br>
    <br>
    <br>
    Scheme+ by Damien Mattei
    <p> </p>
  </body>
</html>
